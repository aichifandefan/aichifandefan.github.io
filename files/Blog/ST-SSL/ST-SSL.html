<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><title>ST-SSL: Spatio-Temporal Self-Supervised Learning for Traffic Prediction (paper and code notes)</title><style>
/* cspell:disable-file */
/* webkit printing magic: print all background colors */
html {
	-webkit-print-color-adjust: exact;
}
* {
	box-sizing: border-box;
	-webkit-print-color-adjust: exact;
}

html,
body {
	margin: 0;
	padding: 0;
}
@media only screen {
	body {
		margin: 2em auto;
		max-width: 900px;
		color: rgb(55, 53, 47);
	}
}

body {
	line-height: 1.5;
	white-space: pre-wrap;
}

a,
a.visited {
	color: inherit;
	text-decoration: underline;
}

.pdf-relative-link-path {
	font-size: 80%;
	color: #444;
}

h1,
h2,
h3 {
	letter-spacing: -0.01em;
	line-height: 1.2;
	font-weight: 600;
	margin-bottom: 0;
}

.page-title {
	font-size: 2.5rem;
	font-weight: 700;
	margin-top: 0;
	margin-bottom: 0.75em;
}

h1 {
	font-size: 1.875rem;
	margin-top: 1.875rem;
}

h2 {
	font-size: 1.5rem;
	margin-top: 1.5rem;
}

h3 {
	font-size: 1.25rem;
	margin-top: 1.25rem;
}

.source {
	border: 1px solid #ddd;
	border-radius: 3px;
	padding: 1.5em;
	word-break: break-all;
}

.callout {
	border-radius: 3px;
	padding: 1rem;
}

figure {
	margin: 1.25em 0;
	page-break-inside: avoid;
}

figcaption {
	opacity: 0.5;
	font-size: 85%;
	margin-top: 0.5em;
}

mark {
	background-color: transparent;
}

.indented {
	padding-left: 1.5em;
}

hr {
	background: transparent;
	display: block;
	width: 100%;
	height: 1px;
	visibility: visible;
	border: none;
	border-bottom: 1px solid rgba(55, 53, 47, 0.09);
}

img {
	max-width: 100%;
}

@media only print {
	img {
		max-height: 100vh;
		object-fit: contain;
	}
}

@page {
	margin: 1in;
}

.collection-content {
	font-size: 0.875rem;
}

.column-list {
	display: flex;
	justify-content: space-between;
}

.column {
	padding: 0 1em;
}

.column:first-child {
	padding-left: 0;
}

.column:last-child {
	padding-right: 0;
}

.table_of_contents-item {
	display: block;
	font-size: 0.875rem;
	line-height: 1.3;
	padding: 0.125rem;
}

.table_of_contents-indent-1 {
	margin-left: 1.5rem;
}

.table_of_contents-indent-2 {
	margin-left: 3rem;
}

.table_of_contents-indent-3 {
	margin-left: 4.5rem;
}

.table_of_contents-link {
	text-decoration: none;
	opacity: 0.7;
	border-bottom: 1px solid rgba(55, 53, 47, 0.18);
}

table,
th,
td {
	border: 1px solid rgba(55, 53, 47, 0.09);
	border-collapse: collapse;
}

table {
	border-left: none;
	border-right: none;
}

th,
td {
	font-weight: normal;
	padding: 0.25em 0.5em;
	line-height: 1.5;
	min-height: 1.5em;
	text-align: left;
}

th {
	color: rgba(55, 53, 47, 0.6);
}

ol,
ul {
	margin: 0;
	margin-block-start: 0.6em;
	margin-block-end: 0.6em;
}

li > ol:first-child,
li > ul:first-child {
	margin-block-start: 0.6em;
}

ul > li {
	list-style: disc;
}

ul.to-do-list {
	padding-inline-start: 0;
}

ul.to-do-list > li {
	list-style: none;
}

.to-do-children-checked {
	text-decoration: line-through;
	opacity: 0.375;
}

ul.toggle > li {
	list-style: none;
}

ul {
	padding-inline-start: 1.7em;
}

ul > li {
	padding-left: 0.1em;
}

ol {
	padding-inline-start: 1.6em;
}

ol > li {
	padding-left: 0.2em;
}

.mono ol {
	padding-inline-start: 2em;
}

.mono ol > li {
	text-indent: -0.4em;
}

.toggle {
	padding-inline-start: 0em;
	list-style-type: none;
}

/* Indent toggle children */
.toggle > li > details {
	padding-left: 1.7em;
}

.toggle > li > details > summary {
	margin-left: -1.1em;
}

.selected-value {
	display: inline-block;
	padding: 0 0.5em;
	background: rgba(206, 205, 202, 0.5);
	border-radius: 3px;
	margin-right: 0.5em;
	margin-top: 0.3em;
	margin-bottom: 0.3em;
	white-space: nowrap;
}

.collection-title {
	display: inline-block;
	margin-right: 1em;
}

.page-description {
    margin-bottom: 2em;
}

.simple-table {
	margin-top: 1em;
	font-size: 0.875rem;
	empty-cells: show;
}
.simple-table td {
	height: 29px;
	min-width: 120px;
}

.simple-table th {
	height: 29px;
	min-width: 120px;
}

.simple-table-header-color {
	background: rgb(247, 246, 243);
	color: black;
}
.simple-table-header {
	font-weight: 500;
}

time {
	opacity: 0.5;
}

.icon {
	display: inline-block;
	max-width: 1.2em;
	max-height: 1.2em;
	text-decoration: none;
	vertical-align: text-bottom;
	margin-right: 0.5em;
}

img.icon {
	border-radius: 3px;
}

.user-icon {
	width: 1.5em;
	height: 1.5em;
	border-radius: 100%;
	margin-right: 0.5rem;
}

.user-icon-inner {
	font-size: 0.8em;
}

.text-icon {
	border: 1px solid #000;
	text-align: center;
}

.page-cover-image {
	display: block;
	object-fit: cover;
	width: 100%;
	max-height: 30vh;
}

.page-header-icon {
	font-size: 3rem;
	margin-bottom: 1rem;
}

.page-header-icon-with-cover {
	margin-top: -0.72em;
	margin-left: 0.07em;
}

.page-header-icon img {
	border-radius: 3px;
}

.link-to-page {
	margin: 1em 0;
	padding: 0;
	border: none;
	font-weight: 500;
}

p > .user {
	opacity: 0.5;
}

td > .user,
td > time {
	white-space: nowrap;
}

input[type="checkbox"] {
	transform: scale(1.5);
	margin-right: 0.6em;
	vertical-align: middle;
}

p {
	margin-top: 0.5em;
	margin-bottom: 0.5em;
}

.image {
	border: none;
	margin: 1.5em 0;
	padding: 0;
	border-radius: 0;
	text-align: center;
}

.code,
code {
	background: rgba(135, 131, 120, 0.15);
	border-radius: 3px;
	padding: 0.2em 0.4em;
	border-radius: 3px;
	font-size: 85%;
	tab-size: 2;
}

code {
	color: #eb5757;
}

.code {
	padding: 1.5em 1em;
}

.code-wrap {
	white-space: pre-wrap;
	word-break: break-all;
}

.code > code {
	background: none;
	padding: 0;
	font-size: 100%;
	color: inherit;
}

blockquote {
	font-size: 1.25em;
	margin: 1em 0;
	padding-left: 1em;
	border-left: 3px solid rgb(55, 53, 47);
}

.bookmark {
	text-decoration: none;
	max-height: 8em;
	padding: 0;
	display: flex;
	width: 100%;
	align-items: stretch;
}

.bookmark-title {
	font-size: 0.85em;
	overflow: hidden;
	text-overflow: ellipsis;
	height: 1.75em;
	white-space: nowrap;
}

.bookmark-text {
	display: flex;
	flex-direction: column;
}

.bookmark-info {
	flex: 4 1 180px;
	padding: 12px 14px 14px;
	display: flex;
	flex-direction: column;
	justify-content: space-between;
}

.bookmark-image {
	width: 33%;
	flex: 1 1 180px;
	display: block;
	position: relative;
	object-fit: cover;
	border-radius: 1px;
}

.bookmark-description {
	color: rgba(55, 53, 47, 0.6);
	font-size: 0.75em;
	overflow: hidden;
	max-height: 4.5em;
	word-break: break-word;
}

.bookmark-href {
	font-size: 0.75em;
	margin-top: 0.25em;
}

.sans { font-family: ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol"; }
.code { font-family: "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace; }
.serif { font-family: Lyon-Text, Georgia, ui-serif, serif; }
.mono { font-family: iawriter-mono, Nitti, Menlo, Courier, monospace; }
.pdf .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK JP'; }
.pdf:lang(zh-CN) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK SC'; }
.pdf:lang(zh-TW) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK TC'; }
.pdf:lang(ko-KR) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK KR'; }
.pdf .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK JP'; }
.pdf:lang(zh-CN) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC'; }
.pdf:lang(zh-TW) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK TC'; }
.pdf:lang(ko-KR) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK KR'; }
.pdf .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK JP'; }
.pdf:lang(zh-CN) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK SC'; }
.pdf:lang(zh-TW) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK TC'; }
.pdf:lang(ko-KR) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK KR'; }
.pdf .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK JP'; }
.pdf:lang(zh-CN) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC'; }
.pdf:lang(zh-TW) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK TC'; }
.pdf:lang(ko-KR) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK KR'; }
.highlight-default {
	color: rgba(55, 53, 47, 1);
}
.highlight-gray {
	color: rgba(120, 119, 116, 1);
	fill: rgba(120, 119, 116, 1);
}
.highlight-brown {
	color: rgba(159, 107, 83, 1);
	fill: rgba(159, 107, 83, 1);
}
.highlight-orange {
	color: rgba(217, 115, 13, 1);
	fill: rgba(217, 115, 13, 1);
}
.highlight-yellow {
	color: rgba(203, 145, 47, 1);
	fill: rgba(203, 145, 47, 1);
}
.highlight-teal {
	color: rgba(68, 131, 97, 1);
	fill: rgba(68, 131, 97, 1);
}
.highlight-blue {
	color: rgba(51, 126, 169, 1);
	fill: rgba(51, 126, 169, 1);
}
.highlight-purple {
	color: rgba(144, 101, 176, 1);
	fill: rgba(144, 101, 176, 1);
}
.highlight-pink {
	color: rgba(193, 76, 138, 1);
	fill: rgba(193, 76, 138, 1);
}
.highlight-red {
	color: rgba(212, 76, 71, 1);
	fill: rgba(212, 76, 71, 1);
}
.highlight-default_background {
	color: rgba(55, 53, 47, 1);
}
.highlight-gray_background {
	background: rgba(241, 241, 239, 1);
}
.highlight-brown_background {
	background: rgba(244, 238, 238, 1);
}
.highlight-orange_background {
	background: rgba(251, 236, 221, 1);
}
.highlight-yellow_background {
	background: rgba(251, 243, 219, 1);
}
.highlight-teal_background {
	background: rgba(237, 243, 236, 1);
}
.highlight-blue_background {
	background: rgba(231, 243, 248, 1);
}
.highlight-purple_background {
	background: rgba(244, 240, 247, 0.8);
}
.highlight-pink_background {
	background: rgba(249, 238, 243, 0.8);
}
.highlight-red_background {
	background: rgba(253, 235, 236, 1);
}
.block-color-default {
	color: inherit;
	fill: inherit;
}
.block-color-gray {
	color: rgba(120, 119, 116, 1);
	fill: rgba(120, 119, 116, 1);
}
.block-color-brown {
	color: rgba(159, 107, 83, 1);
	fill: rgba(159, 107, 83, 1);
}
.block-color-orange {
	color: rgba(217, 115, 13, 1);
	fill: rgba(217, 115, 13, 1);
}
.block-color-yellow {
	color: rgba(203, 145, 47, 1);
	fill: rgba(203, 145, 47, 1);
}
.block-color-teal {
	color: rgba(68, 131, 97, 1);
	fill: rgba(68, 131, 97, 1);
}
.block-color-blue {
	color: rgba(51, 126, 169, 1);
	fill: rgba(51, 126, 169, 1);
}
.block-color-purple {
	color: rgba(144, 101, 176, 1);
	fill: rgba(144, 101, 176, 1);
}
.block-color-pink {
	color: rgba(193, 76, 138, 1);
	fill: rgba(193, 76, 138, 1);
}
.block-color-red {
	color: rgba(212, 76, 71, 1);
	fill: rgba(212, 76, 71, 1);
}
.block-color-default_background {
	color: inherit;
	fill: inherit;
}
.block-color-gray_background {
	background: rgba(241, 241, 239, 1);
}
.block-color-brown_background {
	background: rgba(244, 238, 238, 1);
}
.block-color-orange_background {
	background: rgba(251, 236, 221, 1);
}
.block-color-yellow_background {
	background: rgba(251, 243, 219, 1);
}
.block-color-teal_background {
	background: rgba(237, 243, 236, 1);
}
.block-color-blue_background {
	background: rgba(231, 243, 248, 1);
}
.block-color-purple_background {
	background: rgba(244, 240, 247, 0.8);
}
.block-color-pink_background {
	background: rgba(249, 238, 243, 0.8);
}
.block-color-red_background {
	background: rgba(253, 235, 236, 1);
}
.select-value-color-uiBlue { background-color: rgba(35, 131, 226, .07); }
.select-value-color-pink { background-color: rgba(245, 224, 233, 1); }
.select-value-color-purple { background-color: rgba(232, 222, 238, 1); }
.select-value-color-green { background-color: rgba(219, 237, 219, 1); }
.select-value-color-gray { background-color: rgba(227, 226, 224, 1); }
.select-value-color-transparentGray { background-color: rgba(227, 226, 224, 0); }
.select-value-color-translucentGray { background-color: rgba(0, 0, 0, 0.06); }
.select-value-color-orange { background-color: rgba(250, 222, 201, 1); }
.select-value-color-brown { background-color: rgba(238, 224, 218, 1); }
.select-value-color-red { background-color: rgba(255, 226, 221, 1); }
.select-value-color-yellow { background-color: rgba(253, 236, 200, 1); }
.select-value-color-blue { background-color: rgba(211, 229, 239, 1); }
.select-value-color-pageGlass { background-color: undefined; }
.select-value-color-washGlass { background-color: undefined; }

.checkbox {
	display: inline-flex;
	vertical-align: text-bottom;
	width: 16;
	height: 16;
	background-size: 16px;
	margin-left: 2px;
	margin-right: 5px;
}

.checkbox-on {
	background-image: url("data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20width%3D%2216%22%20height%3D%2216%22%20fill%3D%22%2358A9D7%22%2F%3E%0A%3Cpath%20d%3D%22M6.71429%2012.2852L14%204.9995L12.7143%203.71436L6.71429%209.71378L3.28571%206.2831L2%207.57092L6.71429%2012.2852Z%22%20fill%3D%22white%22%2F%3E%0A%3C%2Fsvg%3E");
}

.checkbox-off {
	background-image: url("data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20x%3D%220.75%22%20y%3D%220.75%22%20width%3D%2214.5%22%20height%3D%2214.5%22%20fill%3D%22white%22%20stroke%3D%22%2336352F%22%20stroke-width%3D%221.5%22%2F%3E%0A%3C%2Fsvg%3E");
}
	
</style></head><body><article id="11ae1c97-a3fd-80d1-a1f4-e119e404f80b" class="page sans"><header><h1 class="page-title"><strong>ST-SSL: Spatio-Temporal Self-Supervised Learning for Traffic Prediction (paper and code notes)</strong></h1><p class="page-description"></p><table class="properties"><tbody></tbody></table></header><div class="page-body"><nav id="11ae1c97-a3fd-805c-940c-dd51f1b96a28" class="block-color-gray table_of_contents"><div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link" href="#11ae1c97-a3fd-8009-80b1-cb615a73a02b">一、背景与动机</a></div><div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link" href="#11ae1c97-a3fd-80e9-8b81-e94c1e3abed7">二、解决方案</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#11ae1c97-a3fd-80ec-a0e3-e9c737d6b9f4">2.1 时空编码器 (ST Encoder)</a></div><div class="table_of_contents-item table_of_contents-indent-2"><a class="table_of_contents-link" href="#11ae1c97-a3fd-8026-b537-c4f4c4e371a2"><strong>时间卷积 (Temporal Convolution, TC)</strong></a></div><div class="table_of_contents-item table_of_contents-indent-2"><a class="table_of_contents-link" href="#11ae1c97-a3fd-80c3-a3c1-e891b5ec52aa"><strong>空间卷积 (Spatial Convolution, SC)</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#11ae1c97-a3fd-801f-bd4a-f902b3092bdb">2.2 自适应数据增强 (Adaptive Graph Augmentation)</a></div><div class="table_of_contents-item table_of_contents-indent-2"><a class="table_of_contents-link" href="#11ae1c97-a3fd-808c-b553-ee116645b222"><strong>交通级别增强（Traffic-Level Augmentation）</strong></a></div><div class="table_of_contents-item table_of_contents-indent-2"><a class="table_of_contents-link" href="#11ae1c97-a3fd-80af-a5bf-dbdafa2100cf"><strong>图结构级别增强（Graph Topology-Level Augmentation）</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#11ae1c97-a3fd-8039-89d9-d2680d80d7f7">2.3 多任务学习阶段</a></div><div class="table_of_contents-item table_of_contents-indent-2"><a class="table_of_contents-link" href="#11ae1c97-a3fd-8079-ab5b-fdb9b3c086c2"><strong>未来交通流量预测任务</strong></a></div><div class="table_of_contents-item table_of_contents-indent-2"><a class="table_of_contents-link" href="#11ae1c97-a3fd-8039-915a-f573562356b8"><strong>空间异质性建模任务</strong></a></div><div class="table_of_contents-item table_of_contents-indent-2"><a class="table_of_contents-link" href="#11ae1c97-a3fd-8022-91da-d4816a72644c"><strong>时间异质性建模任务</strong></a></div><div class="table_of_contents-item table_of_contents-indent-2"><a class="table_of_contents-link" href="#11ae1c97-a3fd-80fd-987a-c108d1b7c342">优化目标</a></div><div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link" href="#11ae1c97-a3fd-80f3-850a-d690a1a776ad">三、实验分析</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#11ae1c97-a3fd-8086-b16a-f269b9b5b30d">3.1 实验设置</a></div><div class="table_of_contents-item table_of_contents-indent-2"><a class="table_of_contents-link" href="#11ae1c97-a3fd-8098-bb20-c402c292c8e4">数据集介绍</a></div><div class="table_of_contents-item table_of_contents-indent-2"><a class="table_of_contents-link" href="#11ae1c97-a3fd-8042-98ef-cf5d1aa0352c">评估指标</a></div><div class="table_of_contents-item table_of_contents-indent-2"><a class="table_of_contents-link" href="#11ae1c97-a3fd-8069-8f0a-daaa39bed7b1">实验评估</a></div><div class="table_of_contents-item table_of_contents-indent-2"><a class="table_of_contents-link" href="#11ae1c97-a3fd-8070-bbd8-e9e34845a392">消融实验</a></div><div class="table_of_contents-item table_of_contents-indent-2"><a class="table_of_contents-link" href="#11ae1c97-a3fd-8035-a0df-d7c7a812ce91"><strong>模型对异质性数据的鲁棒性</strong></a></div><div class="table_of_contents-item table_of_contents-indent-2"><a class="table_of_contents-link" href="#11ae1c97-a3fd-8030-a590-d2cb79bd34c4"><strong>图结构级别增强分析</strong></a></div><div class="table_of_contents-item table_of_contents-indent-2"><a class="table_of_contents-link" href="#11ae1c97-a3fd-8096-8d29-daffcbc830bb">可视化嵌入分析</a></div><div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link" href="#11ae1c97-a3fd-8009-b93f-d5989abde4d1">四、文章贡献与启发</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#11ae1c97-a3fd-80c6-a5ed-d47c23839979">主要贡献：</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#11ae1c97-a3fd-80d0-97ae-d215551292cd">可改进地方探究：</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#11be1c97-a3fd-8091-a89c-f868037b4634">对交通流预测的一些初步想法</a></div><div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link" href="#11be1c97-a3fd-801b-be63-ca4ada29b96e">五、代码复现</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#11be1c97-a3fd-80bf-b3f5-d390935e2fdb">5.1 代码详细分析</a></div><div class="table_of_contents-item table_of_contents-indent-2"><a class="table_of_contents-link" href="#11be1c97-a3fd-80b1-9149-c21509a32372">网络整体结构</a></div><div class="table_of_contents-item table_of_contents-indent-2"><a class="table_of_contents-link" href="#11be1c97-a3fd-8096-b9f0-c9f715de4958">空间异质性建模</a></div><div class="table_of_contents-item table_of_contents-indent-2"><a class="table_of_contents-link" href="#11be1c97-a3fd-8012-94e2-d4353e1de91f">时间异质性建模</a></div><div class="table_of_contents-item table_of_contents-indent-2"><a class="table_of_contents-link" href="#11be1c97-a3fd-80a6-8325-d73292e63061">时空编码器 (ST Encoder)</a></div><div class="table_of_contents-item table_of_contents-indent-2"><a class="table_of_contents-link" href="#11be1c97-a3fd-8074-8698-f36fe63d5028">自适应数据增强</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#11be1c97-a3fd-8062-a553-d7f09fc9af71">5.2 实验结果复现分析</a></div></nav><h1 id="11ae1c97-a3fd-8009-80b1-cb615a73a02b" class="">一、背景与动机</h1><p id="11ae1c97-a3fd-80e0-a14f-ddf2336eac89" class="">城市交通流量预测在智能交通系统中起着关键作用，但现有方法存在两个主要局限：</p><ul id="11ae1c97-a3fd-803e-92e9-c80b952f61a0" class="bulleted-list"><li style="list-style-type:disc"><strong>空间异质性（Spatial Heterogeneity）</strong>：不同城市区域的交通流量特性差异很大（如交通枢纽和住宅区的交通流量差异），但大多数现有模型未能充分考虑这种差异，通常采用统一的参数空间来预测所有区域的流量，导致对流量较大的区域有偏差。</li></ul><ul id="11ae1c97-a3fd-805a-b44f-e68d7f12f97c" class="bulleted-list"><li style="list-style-type:disc"><strong>时间异质性（Temporal Heterogeneity）</strong>：交通流量的时间模式在一天的不同时间段中会有明显的变化，尤其是高峰期和非高峰期，工作日和节假日的流量也有显著不同。然而，大多数现有方法无法有效捕捉这种时间动态变化，采用相同的模型参数对所有时间段进行预测，这限制了模型的准确性。</li></ul><p id="11ae1c97-a3fd-80c3-b45f-c46ca3ed8337" class="">
</p><figure id="11ae1c97-a3fd-8034-b3ca-fa542bb86d77" class="image"><a href="ST-SSL%20Spatio-Temporal%20Self-Supervised%20Learning%20fo%2011ae1c97a3fd80d1a1f4e119e404f80b/image.png"><img style="width:2458px" src="ST-SSL%20Spatio-Temporal%20Self-Supervised%20Learning%20fo%2011ae1c97a3fd80d1a1f4e119e404f80b/image.png"/></a><figcaption>            </figcaption></figure><p id="11ae1c97-a3fd-80a3-9fcd-e9801396c8b4" class="">                                                            <strong>       图1 交通流数据的时空异质性</strong></p><p id="11ae1c97-a3fd-80c9-bd76-f8b38eb50b6c" class="">如图1所示，图1通过三个子图直观地展示了不同区域和时间段中交通流量模式的差异：</p><ul id="11ae1c97-a3fd-8098-99a4-d06233df5cc7" class="bulleted-list"><li style="list-style-type:disc"><strong>(a) 区域的不同功能</strong>：这一部分展示了北京的两个典型区域，A表示一个交通枢纽（如火车站或机场），B表示一个住宅区。这些区域由于其功能的不同，交通流量的特性也会有所不同。例如，交通枢纽的流量在一天中的各个时段可能都比较繁忙，而住宅区的流量可能主要集中在早晚高峰。</li></ul><ul id="11ae1c97-a3fd-80d6-89f2-e89c5fc8bc0c" class="bulleted-list"><li style="list-style-type:disc"><strong>(b) 空间异质性</strong>：这一部分进一步展示了A和B区域的流量分布差异。可以看到，交通枢纽区域的交通流量较高并且分布较广，而住宅区的交通流量则相对较低且较集中。图中展示了区域流量分布不均衡的现象，这正是论文试图解决的空间异质性问题。现有的模型往往会忽视这种差异，导致对高流量区域的偏差。</li></ul><ul id="11ae1c97-a3fd-80a0-805f-fd7f55e9c56b" class="bulleted-list"><li style="list-style-type:disc"><strong>(c) 时间异质性</strong>：这一部分展示了不同时间段的交通模式变化。具体来说，早上、傍晚、夜晚等时间段的交通流量模式各不相同，且工作日和节假日的交通模式也可能存在显著差异。例如，傍晚的交通流量可能在工作日和节假日之间变化较大。这表明，不同时间段的交通流量有显著的异质性，现有模型往往难以有效捕捉这种时间变化。</li></ul><p id="11ae1c97-a3fd-808f-9b25-f2f98874c1bd" class="">
</p><h1 id="11ae1c97-a3fd-80e9-8b81-e94c1e3abed7" class="">二、解决方案</h1><p id="11ae1c97-a3fd-8073-aedd-c0de357cc3af" class="">为了解决上述问题，作者提出了<strong>时空自监督学习（ST-SSL）框架如图2所示。</strong>它是一个基于自监督学习的交通流预测框架，由三个部分组成: (1) 一个时空编码器 (ST Encoder)，从输入的交通数据生成区域嵌入。(2) 一种自适应数据增强方法 (Adaptive Graph Augmentation)，用于构建流量增强，以数据驱动的方式消除数据异质性。(3) 多任务学习阶段，通过未来预测、空间异质性建模、时间异质性建模这三个任务协同工作，帮助模型从不同维度学习更全面的时空信息，提高对交通流量的预测能力。</p><p id="11ae1c97-a3fd-80df-986c-e62ddc6af39f" class="">
</p><figure id="11ae1c97-a3fd-8074-983f-cf4639412a10" class="image"><a href="ST-SSL%20Spatio-Temporal%20Self-Supervised%20Learning%20fo%2011ae1c97a3fd80d1a1f4e119e404f80b/image%201.png"><img style="width:2502px" src="ST-SSL%20Spatio-Temporal%20Self-Supervised%20Learning%20fo%2011ae1c97a3fd80d1a1f4e119e404f80b/image%201.png"/></a></figure><p id="11ae1c97-a3fd-80c6-9fbb-cef4c4fdf067" class="">                                                            <strong>       图2 ST-SSL整体框架</strong></p><p id="11ae1c97-a3fd-80bc-a392-db2ccc70fb7c" class="">
</p><h2 id="11ae1c97-a3fd-80ec-a0e3-e9c737d6b9f4" class="">2.1 时空编码器 (ST Encoder)</h2><p id="11ae1c97-a3fd-8000-8158-c2abf4633d0e" class="">时空编码器结构与<strong>STGCN</strong>一样采用“sandwich”组合结构，由TC→SC→TC的顺序构成。这种层次结构允许模型在时间和空间上进行多次的信息聚合和传播。</p><h3 id="11ae1c97-a3fd-8026-b537-c4f4c4e371a2" class=""><strong>时间卷积 (Temporal Convolution, TC)</strong></h3><p id="11ae1c97-a3fd-80da-9395-d1e9b0b22267" class="">时间卷积模块主要负责捕捉交通流量数据在时间维度上的依赖性。它通过1D卷积操作沿着时间轴处理输入的交通数据，提取时间序列模式。具体的公式如下：</p><figure id="11ae1c97-a3fd-80c8-9597-df2ce892b651" class="equation"><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><div class="equation-container"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mo stretchy="false">(</mo><msub><mi>B</mi><mrow><mi>t</mi><mo>−</mo><msub><mi>T</mi><mtext>out</mtext></msub></mrow></msub><mo separator="true">,</mo><mo>…</mo><mo separator="true">,</mo><msub><mi>B</mi><mi>t</mi></msub><mo stretchy="false">)</mo><mo>=</mo><mtext>TC</mtext><mo stretchy="false">(</mo><msub><mi>X</mi><mrow><mi>t</mi><mo>−</mo><mi>T</mi></mrow></msub><mo separator="true">,</mo><mo>…</mo><mo separator="true">,</mo><msub><mi>X</mi><mi>t</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(B_{t-T_{\text{out}}}, \dots, B_{t}) = \text{TC}(X_{t-T}, \dots, X_t)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0001em;vertical-align:-0.2501em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.0502em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2963em;"><span style="top:-2.357em;margin-left:-0.1389em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">out</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2501em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner">…</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0502em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord">TC</span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner">…</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></div></figure><p id="11ae1c97-a3fd-807d-bae0-ff838c7f402d" class="">其中：</p><ul id="11ae1c97-a3fd-8002-8df8-d3efba34df83" class="bulleted-list"><li style="list-style-type:disc"><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>X</mi><mrow><mi>t</mi><mo>−</mo><mi>T</mi></mrow></msub><mo separator="true">,</mo><mo>…</mo><mo separator="true">,</mo><msub><mi>X</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">X_{t-T}, \dots, X_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8917em;vertical-align:-0.2083em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner">…</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span>﻿</span></span> 表示从时间步 <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi><mo>−</mo><mi>T</mi><mtext> </mtext></mrow><annotation encoding="application/x-tex">t-T </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6984em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="mord"> </span></span></span></span></span><span>﻿</span></span>到 <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi><mtext>  </mtext></mrow><annotation encoding="application/x-tex">t  </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6151em;"></span><span class="mord mathnormal">t</span><span class="mord">  </span></span></span></span></span><span>﻿</span></span>的交通流量输入数据。</li></ul><ul id="11ae1c97-a3fd-80dd-9082-cfad8d3ed4f6" class="bulleted-list"><li style="list-style-type:disc"> <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>B</mi><mi>t</mi></msub><mo>∈</mo><msup><mi mathvariant="double-struck">R</mi><mrow><mi>N</mi><mo>×</mo><mi>D</mi></mrow></msup><mtext>  </mtext></mrow><annotation encoding="application/x-tex">B_t \in \mathbb{R}^{N \times D}  </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0502em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8413em;"></span><span class="mord"><span class="mord mathbb">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">N</span><span class="mbin mtight">×</span><span class="mord mathnormal mtight" style="margin-right:0.02778em;">D</span></span></span></span></span></span></span></span></span><span class="mord">  </span></span></span></span></span><span>﻿</span></span>表示在时间步 <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi><mtext>  </mtext></mrow><annotation encoding="application/x-tex">t  </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6151em;"></span><span class="mord mathnormal">t</span><span class="mord">  </span></span></span></span></span><span>﻿</span></span>的区域嵌入矩阵，其中<style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext> </mtext><mi>N</mi><mtext>  </mtext></mrow><annotation encoding="application/x-tex">  N  </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord"> </span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mord">  </span></span></span></span></span><span>﻿</span></span>是区域数量，<style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>D</mi><mtext>  </mtext></mrow><annotation encoding="application/x-tex">D  </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mord">  </span></span></span></span></span><span>﻿</span></span>是嵌入维度。</li></ul><ul id="11ae1c97-a3fd-8024-9006-da332306cc56" class="bulleted-list"><li style="list-style-type:disc"> <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>T</mi><mtext>out</mtext></msub><mtext>  </mtext></mrow><annotation encoding="application/x-tex">T_{\text{out}}  </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">out</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">  </span></span></span></span></span><span>﻿</span></span>是经过时间卷积后的输出序列长度。</li></ul><p id="11ae1c97-a3fd-80a8-8f08-fe9b3643e41f" class="">
</p><h3 id="11ae1c97-a3fd-80c3-a3c1-e891b5ec52aa" class=""><strong>空间卷积 (Spatial Convolution, SC)</strong></h3><p id="11ae1c97-a3fd-806d-8068-c6d152749c5a" class="">空间卷积模块通过图卷积（Graph Convolution, GCN）来捕捉不同区域之间的空间依赖关系。它使用区域的邻接矩阵  A  来建模相邻区域的相互影响。公式表示为：</p><figure id="11ae1c97-a3fd-8084-b762-c7723190bbbc" class="equation"><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><div class="equation-container"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>E</mi><mi>t</mi></msub><mo>=</mo><mtext>SC</mtext><mo stretchy="false">(</mo><msub><mi>B</mi><mi>t</mi></msub><mo separator="true">,</mo><mi>A</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">
E_t = \text{SC}(B_t, A)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord">SC</span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0502em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">A</span><span class="mclose">)</span></span></span></span></span></div></figure><p id="11ae1c97-a3fd-80eb-bbb1-ddeabf6b1430" class="">其中：</p><ul id="11ae1c97-a3fd-800d-8dba-f9a93d3c828b" class="bulleted-list"><li style="list-style-type:disc"> <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>B</mi><mi>t</mi></msub><mtext>  </mtext></mrow><annotation encoding="application/x-tex">B_t  </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0502em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">  </span></span></span></span></span><span>﻿</span></span>是时间卷积模块生成的区域嵌入矩阵。</li></ul><ul id="11ae1c97-a3fd-806a-ad7d-f1e4e8703e55" class="bulleted-list"><li style="list-style-type:disc"> <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>∈</mo><msup><mi mathvariant="double-struck">R</mi><mrow><mi>N</mi><mo>×</mo><mi>N</mi></mrow></msup><mtext>  </mtext></mrow><annotation encoding="application/x-tex">A \in \mathbb{R}^{N \times N}  </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7224em;vertical-align:-0.0391em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8413em;"></span><span class="mord"><span class="mord mathbb">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">N</span><span class="mbin mtight">×</span><span class="mord mathnormal mtight" style="margin-right:0.10903em;">N</span></span></span></span></span></span></span></span></span><span class="mord">  </span></span></span></span></span><span>﻿</span></span>是表示区域之间邻接关系的邻接矩阵。</li></ul><ul id="11ae1c97-a3fd-8021-9f57-cb039b562277" class="bulleted-list"><li style="list-style-type:disc"> <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>E</mi><mi>t</mi></msub><mo>∈</mo><msup><mi mathvariant="double-struck">R</mi><mrow><mi>N</mi><mo>×</mo><mi>D</mi></mrow></msup><mtext>  </mtext></mrow><annotation encoding="application/x-tex">E_t \in \mathbb{R}^{N \times D}  </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8413em;"></span><span class="mord"><span class="mord mathbb">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">N</span><span class="mbin mtight">×</span><span class="mord mathnormal mtight" style="margin-right:0.02778em;">D</span></span></span></span></span></span></span></span></span><span class="mord">  </span></span></span></span></span><span>﻿</span></span>是经过空间卷积后的嵌入矩阵，它结合了区域之间的地理相关性。</li></ul><p id="11ae1c97-a3fd-801b-9d8d-cfb29b4743b2" class="">
</p><h2 id="11ae1c97-a3fd-801f-bd4a-f902b3092bdb" class="">2.2 自适应数据增强 (Adaptive Graph Augmentation)</h2><p id="11ae1c97-a3fd-80d1-8e89-f9ae988b4b5c" class="">自适应数据增强是文章中的一个关键模块，用于处理交通流量数据中的空间和时间异质性。该模块通过两种增强方式：<strong>交通级别增强(Traffic-Level Augmentation)</strong>和<strong>图结构级别增强 (Graph Topology-level Augmentation)</strong>，根据区域交通模式的依赖性，自适应地调整数据，从而提高模型的鲁棒性和对异质性数据的适应能力。框架图如图3所示。</p><p id="11ae1c97-a3fd-80d9-8324-d7196b19dc5f" class="">
</p><figure id="11ae1c97-a3fd-801b-a410-c6289208d355" class="image"><a href="ST-SSL%20Spatio-Temporal%20Self-Supervised%20Learning%20fo%2011ae1c97a3fd80d1a1f4e119e404f80b/image%202.png"><img style="width:2328px" src="ST-SSL%20Spatio-Temporal%20Self-Supervised%20Learning%20fo%2011ae1c97a3fd80d1a1f4e119e404f80b/image%202.png"/></a></figure><p id="11ae1c97-a3fd-8068-b320-c60962d9127b" class="">                                                            <strong>       图3 ST Encoder 和AdaAug框架图</strong></p><p id="11ae1c97-a3fd-801a-a66e-c3b5c22a1e92" class="">
</p><h3 id="11ae1c97-a3fd-808c-b553-ee116645b222" class=""><strong>交通级别增强（Traffic-Level Augmentation）</strong></h3><p id="11ae1c97-a3fd-803b-8beb-cddcad0d2cf7" class="">交通级别增强通过计算每个时间步的相关性，动态掩盖与整体模式相关性低的交通数据，从而减少噪声，优化模型的输入数据。生成的增强数据保留了与区域交通模式高度相关的时间步数据，而与整体模式相关性低的数据被掩盖。这样，模型能够更加专注于重要的时间步数据，提升对区域交通流的预测能力。以下是其具体操作步骤：</p><p id="11ae1c97-a3fd-8073-a657-cfd9180f02fc" class=""><strong>区域嵌入的生成: </strong>首先，对每个区域 <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>r</mi><mi>n</mi></msub><mtext>  </mtext></mrow><annotation encoding="application/x-tex">r_n  </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">  </span></span></span></span></span><span>﻿</span></span>在不同时间步的数据生成一个嵌入表示序列 <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><msub><mi>b</mi><mrow><mi>t</mi><mo>−</mo><mi>T</mi><mo separator="true">,</mo><mi>n</mi></mrow></msub><mo separator="true">,</mo><mo>…</mo><mo separator="true">,</mo><msub><mi>b</mi><mrow><mi>t</mi><mo separator="true">,</mo><mi>n</mi></mrow></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(b_{t-T,n}, \dots, b_{t,n})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0361em;vertical-align:-0.2861em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner">…</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span><span>﻿</span></span> 这些嵌入来自ST Encoder的第一个时间卷积模块(TC)。接着，利用这些嵌入计算区域的整体交通模式表示 <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext> </mtext><msub><mi>u</mi><mi>n</mi></msub><mtext> </mtext></mrow><annotation encoding="application/x-tex"> u_n </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"> </span><span class="mord"><span class="mord mathnormal">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"> </span></span></span></span></span><span>﻿</span></span>，公式如下：</p><figure id="11ae1c97-a3fd-802f-8f4c-d89198611a34" class="equation"><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><div class="equation-container"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>u</mi><mi>n</mi></msub><mo>=</mo><munderover><mo>∑</mo><mrow><mi>τ</mi><mo>=</mo><mi>t</mi><mo>−</mo><mi>T</mi></mrow><mi>t</mi></munderover><msub><mi>p</mi><mrow><mi>τ</mi><mo separator="true">,</mo><mi>n</mi></mrow></msub><mo>⋅</mo><msub><mi>b</mi><mrow><mi>τ</mi><mo separator="true">,</mo><mi>n</mi></mrow></msub><mo separator="true">,</mo><mtext> </mtext><mi>w</mi><mi>h</mi><mi>e</mi><mi>r</mi><mi>e</mi><mtext>  </mtext><msub><mi>p</mi><mrow><mi>τ</mi><mo separator="true">,</mo><mi>n</mi></mrow></msub><mo>=</mo><msubsup><mi>b</mi><mrow><mi>τ</mi><mo separator="true">,</mo><mi>n</mi></mrow><mi mathvariant="normal">⊤</mi></msubsup><msub><mi>w</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">
u_n = \sum_{\tau=t-T}^{t} p_{\tau,n} \cdot b_{\tau,n},\ where   \ \   p_{\tau,n} = b_{\tau,n}^\top w_0  </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:3.1332em;vertical-align:-1.3527em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.7806em;"><span style="top:-1.8557em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.1132em;">τ</span><span class="mrel mtight">=</span><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.3527em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.1132em;">τ</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.9805em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.1132em;">τ</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace"> </span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="mord mathnormal">h</span><span class="mord mathnormal">ere</span><span class="mspace"> </span><span class="mspace"> </span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.1132em;">τ</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.2822em;vertical-align:-0.3831em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8991em;"><span style="top:-2.453em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.1132em;">τ</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">n</span></span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">⊤</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3831em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span></div></figure><p id="11ae1c97-a3fd-807e-9fdb-c6c7a4686ab0" class="">其中：</p><ul id="11ae1c97-a3fd-8014-92e6-f30f24e05933" class="bulleted-list"><li style="list-style-type:disc"><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext> </mtext><msub><mi>u</mi><mi>n</mi></msub><mtext> </mtext></mrow><annotation encoding="application/x-tex"> u_n </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"> </span><span class="mord"><span class="mord mathnormal">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"> </span></span></span></span></span><span>﻿</span></span>表示区域 <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext> </mtext><msub><mi>r</mi><mi>n</mi></msub><mtext>  </mtext></mrow><annotation encoding="application/x-tex">  r_n  </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"> </span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">  </span></span></span></span></span><span>﻿</span></span>在过去 <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext> </mtext><mi>T</mi><mtext>  </mtext></mrow><annotation encoding="application/x-tex">  T  </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord"> </span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="mord">  </span></span></span></span></span><span>﻿</span></span>个时间步的总体交通模式嵌入。</li></ul><ul id="11ae1c97-a3fd-8037-9a71-cca1a2cf6604" class="bulleted-list"><li style="list-style-type:disc"> <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>p</mi><mrow><mi>τ</mi><mo separator="true">,</mo><mi>n</mi></mrow></msub><mtext>  </mtext></mrow><annotation encoding="application/x-tex">p_{\tau,n}  </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7167em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.1132em;">τ</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mord">  </span></span></span></span></span><span>﻿</span></span>是时间步<style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext> </mtext><mi>τ</mi><mtext>  </mtext></mrow><annotation encoding="application/x-tex">  \tau  </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord"> </span><span class="mord mathnormal" style="margin-right:0.1132em;">τ</span><span class="mord">  </span></span></span></span></span><span>﻿</span></span>和区域整体交通模式之间的相关性权重，<style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext> </mtext><msub><mi>w</mi><mn>0</mn></msub><mtext>  </mtext></mrow><annotation encoding="application/x-tex"> w_0  </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"> </span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">  </span></span></span></span></span><span>﻿</span></span>是一个可学习的参数向量。</li></ul><p id="11ae1c97-a3fd-8084-bdf5-d4e7e6f6ec74" class="">
</p><p id="11ae1c97-a3fd-8084-9fd3-f919158197da" class=""><strong>相关性掩码的生成：</strong>根据计算的相关性权重 <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext> </mtext><msub><mi>p</mi><mrow><mi>τ</mi><mo separator="true">,</mo><mi>n</mi></mrow></msub><mtext> </mtext></mrow><annotation encoding="application/x-tex">  p_{\tau,n} </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7167em;vertical-align:-0.2861em;"></span><span class="mord"> </span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.1132em;">τ</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mord"> </span></span></span></span></span><span>﻿</span></span>，每个时间步<style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext> </mtext><mi>τ</mi><mtext>  </mtext></mrow><annotation encoding="application/x-tex">  \tau  </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord"> </span><span class="mord mathnormal" style="margin-right:0.1132em;">τ</span><span class="mord">  </span></span></span></span></span><span>﻿</span></span>的交通流量数据都会被赋予一个掩码概率 <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ρ</mi><mrow><mi>τ</mi><mo separator="true">,</mo><mi>n</mi></mrow></msub><mtext> </mtext></mrow><annotation encoding="application/x-tex">\rho_{\tau,n} </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7167em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal">ρ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.1132em;">τ</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mord"> </span></span></span></span></span><span>﻿</span></span>，其值由伯努利分布决定，具体公式为：</p><figure id="11ae1c97-a3fd-80b1-aa20-d75ef22faad7" class="equation"><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><div class="equation-container"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>ρ</mi><mrow><mi>τ</mi><mo separator="true">,</mo><mi>n</mi></mrow></msub><mo>∼</mo><mtext>Bernoulli</mtext><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><msub><mi>p</mi><mrow><mi>τ</mi><mo separator="true">,</mo><mi>n</mi></mrow></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">
\rho_{\tau,n} \sim \text{Bernoulli}(1 - p_{\tau,n})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7167em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal">ρ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.1132em;">τ</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∼</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord">Bernoulli</span></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.0361em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.1132em;">τ</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></div></figure><p id="11ae1c97-a3fd-80e1-a82a-fc722a0b16fc" class="">其中，<style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext> </mtext><msub><mi>p</mi><mrow><mi>τ</mi><mo separator="true">,</mo><mi>n</mi></mrow></msub><mtext>  </mtext></mrow><annotation encoding="application/x-tex"> p_{\tau,n}  </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7167em;vertical-align:-0.2861em;"></span><span class="mord"> </span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.1132em;">τ</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mord">  </span></span></span></span></span><span>﻿</span></span>越低，表示该时间步的交通数据与该区域的整体交通模式相关性较弱，掩码概率<style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ρ</mi><mrow><mi>τ</mi><mo separator="true">,</mo><mi>n</mi></mrow></msub><mtext>  </mtext></mrow><annotation encoding="application/x-tex">\rho_{\tau,n}  </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7167em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal">ρ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.1132em;">τ</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mord">  </span></span></span></span></span><span>﻿</span></span>越高。这意味着相关性较低的流量数据更有可能被掩盖，减少噪声对模型的干扰。</p><p id="11ae1c97-a3fd-80a9-888d-f4878b78ee78" class="">
</p><p id="11ae1c97-a3fd-8041-b1b3-c5a3088dd342" class=""><strong>交通数据的掩盖与增强：</strong>通过以上步骤，针对每个区域 <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext> </mtext><msub><mi>r</mi><mi>n</mi></msub><mtext>  </mtext></mrow><annotation encoding="application/x-tex"> r_n  </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"> </span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">  </span></span></span></span></span><span>﻿</span></span>在时间步 <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>τ</mi><mtext>  </mtext></mrow><annotation encoding="application/x-tex">\tau  </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.1132em;">τ</span><span class="mord">  </span></span></span></span></span><span>﻿</span></span>的交通数据 <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext> </mtext><msub><mi>x</mi><mrow><mi>τ</mi><mo separator="true">,</mo><mi>n</mi></mrow></msub><mtext> </mtext></mrow><annotation encoding="application/x-tex"> x_{\tau,n} </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7167em;vertical-align:-0.2861em;"></span><span class="mord"> </span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.1132em;">τ</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mord"> </span></span></span></span></span><span>﻿</span></span>，根据掩码概率 <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext> </mtext><msub><mi>ρ</mi><mrow><mi>τ</mi><mo separator="true">,</mo><mi>n</mi></mrow></msub><mtext>  </mtext></mrow><annotation encoding="application/x-tex"> \rho_{\tau,n}  </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7167em;vertical-align:-0.2861em;"></span><span class="mord"> </span><span class="mord"><span class="mord mathnormal">ρ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.1132em;">τ</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mord">  </span></span></span></span></span><span>﻿</span></span>进行掩盖。掩盖后的增强数据表示为 <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover accent="true"><mi>X</mi><mo>~</mo></mover><mrow><mi>t</mi><mo>−</mo><mi>T</mi><mo>:</mo><mi>t</mi></mrow></msub><mtext> </mtext></mrow><annotation encoding="application/x-tex">\tilde{X}_{t-T:t} </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1285em;vertical-align:-0.2083em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9202em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span></span><span style="top:-3.6023em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1667em;"><span class="mord">~</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span><span class="mrel mtight">:</span><span class="mord mathnormal mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mord"> </span></span></span></span></span><span>﻿</span></span>，其每个时间步的数据部分会被随机掩盖，从而生成一个去除了噪声的增强交通流数据。生成的增强数据 <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover accent="true"><mi>X</mi><mo>~</mo></mover><mrow><mi>t</mi><mo>−</mo><mi>T</mi><mo>:</mo><mi>t</mi></mrow></msub><mtext>  </mtext></mrow><annotation encoding="application/x-tex">\tilde{X}_{t-T:t}  </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1285em;vertical-align:-0.2083em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9202em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span></span><span style="top:-3.6023em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1667em;"><span class="mord">~</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span><span class="mrel mtight">:</span><span class="mord mathnormal mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mord">  </span></span></span></span></span><span>﻿</span></span>保留了与区域交通模式高度相关的时间步数据，而与整体模式相关性低的数据被掩盖。这样，模型能够更加专注于重要的时间步数据，提升对区域交通流的预测能力。</p><p id="11ae1c97-a3fd-80f4-948c-e505d9a64ec0" class="">
</p><h3 id="11ae1c97-a3fd-80af-a5bf-dbdafa2100cf" class=""><strong>图结构级别增强（Graph Topology-Level Augmentation）</strong></h3><p id="11ae1c97-a3fd-80fe-b6e8-f3cd6f1ca914" class="">图结构级别增强的目标是基于区域间的交通模式差异，对交通流图的结构进行自适应调整。通过移除或增加图中的边（区域之间的连接），该方法旨在更好地建模不同区域的空间依赖关系，具体操作步骤如下：</p><p id="11ae1c97-a3fd-8068-b989-cc3c0e9b8089" class=""><strong>区域间交通模式相似性计算: </strong>为了判断区域之间的交通模式是否相似，首先计算每对区域 <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext> </mtext><msub><mi>r</mi><mi>m</mi></msub><mtext>  </mtext></mrow><annotation encoding="application/x-tex">  r_m  </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"> </span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">  </span></span></span></span></span><span>﻿</span></span>和 <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>r</mi><mi>n</mi></msub><mtext>  </mtext></mrow><annotation encoding="application/x-tex">r_n  </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">  </span></span></span></span></span><span>﻿</span></span>之间的相似性度量 <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>q</mi><mrow><mi>m</mi><mo separator="true">,</mo><mi>n</mi></mrow></msub><mtext> </mtext></mrow><annotation encoding="application/x-tex">q_{m,n} </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7167em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">m</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mord"> </span></span></span></span></span><span>﻿</span></span>，用来反映两个区域的交通流模式在时间维度上的相互依赖性。公式如下：</p><figure id="11ae1c97-a3fd-8091-9e7d-f0c9b9e5f801" class="equation"><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><div class="equation-container"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>q</mi><mrow><mi>m</mi><mo separator="true">,</mo><mi>n</mi></mrow></msub><mo>=</mo><mfrac><mrow><msubsup><mi>u</mi><mi>m</mi><mi mathvariant="normal">⊤</mi></msubsup><msub><mi>u</mi><mi>n</mi></msub></mrow><mrow><mi mathvariant="normal">∥</mi><msub><mi>u</mi><mi>m</mi></msub><mi mathvariant="normal">∥</mi><mi mathvariant="normal">∥</mi><msub><mi>u</mi><mi>n</mi></msub><mi mathvariant="normal">∥</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex">
q_{m,n} = \frac{u_m^\top u_n}{\|u_m\| \|u_n\|}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7167em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">m</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.4621em;vertical-align:-0.936em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.5261em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">∥</span><span class="mord"><span class="mord mathnormal">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">∥∥</span><span class="mord"><span class="mord mathnormal">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">∥</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8491em;"><span style="top:-2.453em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">⊤</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.936em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></div></figure><p id="11ae1c97-a3fd-80d2-b88f-faf2e8b2cc4a" class="">其中：</p><ul id="11ae1c97-a3fd-80a4-a794-f88ae7cc13c3" class="bulleted-list"><li style="list-style-type:disc"><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext> </mtext><msub><mi>u</mi><mi>m</mi></msub><mtext>  </mtext></mrow><annotation encoding="application/x-tex"> u_m  </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"> </span><span class="mord"><span class="mord mathnormal">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">  </span></span></span></span></span><span>﻿</span></span>和 <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>u</mi><mi>n</mi></msub><mtext>  </mtext></mrow><annotation encoding="application/x-tex">u_n  </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">  </span></span></span></span></span><span>﻿</span></span>分别表示区域 <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext> </mtext><msub><mi>r</mi><mi>m</mi></msub><mtext>  </mtext></mrow><annotation encoding="application/x-tex"> r_m  </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"> </span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">  </span></span></span></span></span><span>﻿</span></span>和 <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>r</mi><mi>n</mi></msub><mtext>  </mtext></mrow><annotation encoding="application/x-tex">r_n  </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">  </span></span></span></span></span><span>﻿</span></span>的整体交通模式嵌入（在交通级别增强部分中通过时间步的加权平均计算）。</li></ul><ul id="11ae1c97-a3fd-802f-886b-d541f66b9c9e" class="bulleted-list"><li style="list-style-type:disc"> <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>q</mi><mrow><mi>m</mi><mo separator="true">,</mo><mi>n</mi></mrow></msub><mtext>  </mtext></mrow><annotation encoding="application/x-tex">q_{m,n}  </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7167em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">m</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mord">  </span></span></span></span></span><span>﻿</span></span>是区域 <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>r</mi><mi>m</mi></msub><mtext>  </mtext></mrow><annotation encoding="application/x-tex">r_m  </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">  </span></span></span></span></span><span>﻿</span></span>和 <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>r</mi><mi>n</mi></msub><mtext>  </mtext></mrow><annotation encoding="application/x-tex">r_n  </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">  </span></span></span></span></span><span>﻿</span></span>的相似性度量，其值越大表示两个区域的交通流模式越相似，依赖性越强。</li></ul><p id="11ae1c97-a3fd-80fb-a6ad-e495c6ea9dcb" class="">
</p><p id="11ae1c97-a3fd-8063-b9f2-f70b226f1b17" class=""><strong>移除区域之间的低相关性连接: </strong>在图结构中，如果两个相邻区域 <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>r</mi><mi>m</mi></msub><mtext>  </mtext></mrow><annotation encoding="application/x-tex">r_m  </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">  </span></span></span></span></span><span>﻿</span></span>和 <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>r</mi><mi>n</mi></msub><mtext>  </mtext></mrow><annotation encoding="application/x-tex">r_n  </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">  </span></span></span></span></span><span>﻿</span></span>的交通模式相似度 <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>q</mi><mrow><mi>m</mi><mo separator="true">,</mo><mi>n</mi></mrow></msub><mtext>  </mtext></mrow><annotation encoding="application/x-tex">q_{m,n}  </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7167em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">m</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mord">  </span></span></span></span></span><span>﻿</span></span>较低，说明它们的交通流模式差异较大，依赖性较弱。此时，通过设置掩码概率 <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ρ</mi><mrow><mi>m</mi><mo separator="true">,</mo><mi>n</mi></mrow></msub><mtext> </mtext></mrow><annotation encoding="application/x-tex">\rho_{m,n} </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7167em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal">ρ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">m</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mord"> </span></span></span></span></span><span>﻿</span></span>，根据伯努利分布决定是否移除它们之间的边：</p><figure id="11ae1c97-a3fd-8062-8e24-ec5bfd17b35d" class="equation"><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><div class="equation-container"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>ρ</mi><mrow><mi>m</mi><mo separator="true">,</mo><mi>n</mi></mrow></msub><mo>∼</mo><mtext>Bernoulli</mtext><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><msub><mi>q</mi><mrow><mi>m</mi><mo separator="true">,</mo><mi>n</mi></mrow></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">
\rho_{m,n} \sim \text{Bernoulli}(1 - q_{m,n})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7167em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal">ρ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">m</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∼</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord">Bernoulli</span></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.0361em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">m</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></div></figure><p id="11ae1c97-a3fd-8031-a638-cfb03fed5aa1" class="">如果 <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ρ</mi><mrow><mi>m</mi><mo separator="true">,</mo><mi>n</mi></mrow></msub><mtext>  </mtext></mrow><annotation encoding="application/x-tex">\rho_{m,n}  </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7167em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal">ρ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">m</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mord">  </span></span></span></span></span><span>﻿</span></span>较高，则说明区域 <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>r</mi><mi>m</mi></msub><mtext>  </mtext></mrow><annotation encoding="application/x-tex">r_m  </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">  </span></span></span></span></span><span>﻿</span></span>和 <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>r</mi><mi>n</mi></msub><mtext>  </mtext></mrow><annotation encoding="application/x-tex">r_n  </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">  </span></span></span></span></span><span>﻿</span></span>的交通流量差异较大，相关性低，模型会有较高概率移除它们之间的连接边。通过移除这些低相关性的连接，图结构中的噪声依赖关系被削弱。</p><p id="11ae1c97-a3fd-8050-beda-e519ca3a7911" class="">
</p><p id="11ae1c97-a3fd-8030-949a-f5d055254b8c" class=""><strong>增加区域之间的高相关性连接: </strong>除了移除低相关性的连接，图结构增强还会增加那些相似度高但空间上非相邻的区域之间的连接。如果两个区域 <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>r</mi><mi>m</mi></msub><mtext>  </mtext></mrow><annotation encoding="application/x-tex">r_m  </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">  </span></span></span></span></span><span>﻿</span></span>和 <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>r</mi><mi>n</mi></msub><mtext>  </mtext></mrow><annotation encoding="application/x-tex">r_n  </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">  </span></span></span></span></span><span>﻿</span></span>的交通模式相似度 <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>q</mi><mrow><mi>m</mi><mo separator="true">,</mo><mi>n</mi></mrow></msub><mtext>  </mtext></mrow><annotation encoding="application/x-tex">q_{m,n}  </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7167em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">m</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mord">  </span></span></span></span></span><span>﻿</span></span>很高，即使它们在空间上并非直接相邻，也会根据相似性度量来增加新的连接边。增加边的掩码概率为：</p><figure id="11ae1c97-a3fd-8025-b6d8-c5d5cbdf1ba2" class="equation"><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><div class="equation-container"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>ρ</mi><mrow><mi>m</mi><mo separator="true">,</mo><mi>n</mi></mrow></msub><mo>∼</mo><mtext>Bernoulli</mtext><mo stretchy="false">(</mo><msub><mi>q</mi><mrow><mi>m</mi><mo separator="true">,</mo><mi>n</mi></mrow></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">
\rho_{m,n} \sim \text{Bernoulli}(q_{m,n})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7167em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal">ρ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">m</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∼</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0361em;vertical-align:-0.2861em;"></span><span class="mord text"><span class="mord">Bernoulli</span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">m</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></div></figure><p id="11ae1c97-a3fd-80a3-ad8e-f00df043e7f1" class="">当 <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>q</mi><mrow><mi>m</mi><mo separator="true">,</mo><mi>n</mi></mrow></msub><mtext>  </mtext></mrow><annotation encoding="application/x-tex">q_{m,n}  </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7167em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">m</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mord">  </span></span></span></span></span><span>﻿</span></span>较高时，模型会有较大概率在这两个区域之间增加边，以捕捉它们之间潜在的远距离依赖关系。通过这种方式，模型能够更好地建模城市中的全局交通流量依赖，而不仅限于局部邻近区域。</p><p id="11ae1c97-a3fd-80db-ad48-e961fe474efa" class="">图的区域相关性移除与连接如图4所示。</p><p id="11ae1c97-a3fd-8011-810d-ef19892f03b2" class="">
</p><figure id="11ae1c97-a3fd-8058-aa4b-e0ed3960d740" class="image"><a href="ST-SSL%20Spatio-Temporal%20Self-Supervised%20Learning%20fo%2011ae1c97a3fd80d1a1f4e119e404f80b/aug.png"><img style="width:707.984375px" src="ST-SSL%20Spatio-Temporal%20Self-Supervised%20Learning%20fo%2011ae1c97a3fd80d1a1f4e119e404f80b/aug.png"/></a></figure><p id="11ae1c97-a3fd-80df-8199-d751d654ce62" class="">                                                            <strong>       图4 图的区域相关性移除与连接</strong></p><p id="11ae1c97-a3fd-8088-9130-e2151bd5fdae" class="">
</p><p id="11ae1c97-a3fd-8037-b540-d0b19babd65e" class=""><strong>生成增强后的交通流图: </strong>经过上述移除和增加边的操作后，最终生成了一个增强后的交通流图  <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><mi>G</mi><mo>~</mo></mover><mo>=</mo><mo stretchy="false">(</mo><mi>V</mi><mo separator="true">,</mo><mover accent="true"><mi>E</mi><mo>~</mo></mover><mo separator="true">,</mo><mover accent="true"><mi>A</mi><mo>~</mo></mover><mo stretchy="false">)</mo><mtext> </mtext></mrow><annotation encoding="application/x-tex">\tilde{G} = (V, \tilde{E}, \tilde{A}) </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9202em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9202em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">G</span></span><span style="top:-3.6023em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1667em;"><span class="mord">~</span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.1702em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9202em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">E</span></span><span style="top:-3.6023em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1667em;"><span class="mord">~</span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9202em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">A</span></span><span style="top:-3.6023em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1111em;"><span class="mord">~</span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord"> </span></span></span></span></span><span>﻿</span></span>。</p><p id="11ae1c97-a3fd-8010-b0bc-c3f83de285f6" class="">其中：</p><ul id="11ae1c97-a3fd-8005-ae02-cbb098324e93" class="bulleted-list"><li style="list-style-type:disc"><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>V</mi><mtext>  </mtext></mrow><annotation encoding="application/x-tex">V  </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="mord">  </span></span></span></span></span><span>﻿</span></span>代表区域节点集合（与原图保持一致）。</li></ul><ul id="11ae1c97-a3fd-8095-81ef-c36d4a9ef440" class="bulleted-list"><li style="list-style-type:disc"> <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><mi>E</mi><mo>~</mo></mover><mtext>  </mtext></mrow><annotation encoding="application/x-tex">\tilde{E}  </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9202em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9202em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">E</span></span><span style="top:-3.6023em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1667em;"><span class="mord">~</span></span></span></span></span></span></span><span class="mord">  </span></span></span></span></span><span>﻿</span></span>是调整后的边集合。</li></ul><ul id="11ae1c97-a3fd-80f1-b09e-e48a5a3deb2b" class="bulleted-list"><li style="list-style-type:disc"> <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><mi>A</mi><mo>~</mo></mover><mtext>  </mtext></mrow><annotation encoding="application/x-tex">\tilde{A}  </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9202em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9202em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">A</span></span><span style="top:-3.6023em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1111em;"><span class="mord">~</span></span></span></span></span></span></span><span class="mord">  </span></span></span></span></span><span>﻿</span></span>是更新后的邻接矩阵，表示区域之间的连接关系。</li></ul><p id="11ae1c97-a3fd-8010-b69b-e81cb43259ff" class="">
</p><h2 id="11ae1c97-a3fd-8039-89d9-d2680d80d7f7" class="">2.3 多任务学习阶段</h2><h3 id="11ae1c97-a3fd-8079-ab5b-fdb9b3c086c2" class=""><strong>未来交通流量预测任务</strong></h3><p id="11ae1c97-a3fd-80f0-860a-ced11660df4f" class="">这是模型的主要任务，目标是根据历史交通数据预测未来时间步的交通流量。模型输入的是历史交通流量数据和增强后的时空嵌入，输出为未来时间步 <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi><mo>+</mo><mn>1</mn><mtext>  </mtext></mrow><annotation encoding="application/x-tex">t+1  </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6984em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1  </span></span></span></span></span><span>﻿</span></span>各区域的流入和流出量。具体过程如下：</p><ul id="11ae1c97-a3fd-800e-b65c-e86835b38cb1" class="bulleted-list"><li style="list-style-type:disc">使用多层感知机 <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>M</mi><mi>L</mi><mi>P</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(MLP)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="mord mathnormal">L</span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mclose">)</span></span></span></span></span><span>﻿</span></span>，将通过时空编码器生成的区域嵌入 <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>h</mi><mi>n</mi></msub><mtext>  </mtext></mrow><annotation encoding="application/x-tex">h_n  </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">  </span></span></span></span></span><span>﻿</span></span>输入到 <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi><mi>L</mi><mi>P</mi></mrow><annotation encoding="application/x-tex">MLP</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="mord mathnormal">L</span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span></span></span></span></span><span>﻿</span></span> 中，预测区域  <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>r</mi><mi>n</mi></msub><mtext>  </mtext></mrow><annotation encoding="application/x-tex">r_n  </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">  </span></span></span></span></span><span>﻿</span></span>在未来时间步 <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi><mo>+</mo><mn>1</mn><mtext>  </mtext></mrow><annotation encoding="application/x-tex">t+1  </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6984em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1  </span></span></span></span></span><span>﻿</span></span>的交通流量。预测公式为：<style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover accent="true"><mi>x</mi><mo>^</mo></mover><mrow><mi>t</mi><mo>+</mo><mn>1</mn><mo separator="true">,</mo><mi>n</mi></mrow></msub><mo>=</mo><mtext>MLP</mtext><mo stretchy="false">(</mo><msub><mi>h</mi><mi>n</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">
\hat{x}_{t+1,n} = \text{MLP}(h_n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9805em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6944em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">x</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2222em;"><span class="mord">^</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">+</span><span class="mord mtight">1</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord">MLP</span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span><span>﻿</span></span></li></ul><ul id="11ae1c97-a3fd-80c4-a4e6-d554c01a85a7" class="bulleted-list"><li style="list-style-type:disc">预测损失函数 <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>L</mi><mi>p</mi></msub><mtext>  </mtext></mrow><annotation encoding="application/x-tex">L_p  </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mord">  </span></span></span></span></span><span>﻿</span></span>用来最小化预测值 <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover accent="true"><mi>x</mi><mo>^</mo></mover><mrow><mi>t</mi><mo>+</mo><mn>1</mn><mo separator="true">,</mo><mi>n</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\hat{x}_{t+1,n}  </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9805em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6944em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">x</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2222em;"><span class="mord">^</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">+</span><span class="mord mtight">1</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span></span><span>﻿</span></span>与真实值 <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn><mo separator="true">,</mo><mi>n</mi></mrow></msub></mrow><annotation encoding="application/x-tex">x_{t+1,n}  </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7167em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">+</span><span class="mord mtight">1</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span></span><span>﻿</span></span>之间的误差，公式为：</li></ul><figure id="11ae1c97-a3fd-8045-9d59-e2b6cdb7b1bd" class="equation"><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><div class="equation-container"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi mathvariant="script">L</mi><mi>p</mi></msub><mo>=</mo><munderover><mo>∑</mo><mrow><mi>n</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></munderover><mi>λ</mi><mrow><mo fence="true">∣</mo><msubsup><mi>x</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn><mo separator="true">,</mo><mi>n</mi></mrow><mrow><mo stretchy="false">(</mo><mn>0</mn><mo stretchy="false">)</mo></mrow></msubsup><mo>−</mo><msubsup><mover accent="true"><mi>x</mi><mo>^</mo></mover><mrow><mi>t</mi><mo>+</mo><mn>1</mn><mo separator="true">,</mo><mi>n</mi></mrow><mrow><mo stretchy="false">(</mo><mn>0</mn><mo stretchy="false">)</mo></mrow></msubsup><mo fence="true">∣</mo></mrow><mo>+</mo><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mi>λ</mi><mo stretchy="false">)</mo><mrow><mo fence="true">∣</mo><msubsup><mi>x</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn><mo separator="true">,</mo><mi>n</mi></mrow><mrow><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></msubsup><mo>−</mo><msubsup><mover accent="true"><mi>x</mi><mo>^</mo></mover><mrow><mi>t</mi><mo>+</mo><mn>1</mn><mo separator="true">,</mo><mi>n</mi></mrow><mrow><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></msubsup><mo fence="true">∣</mo></mrow></mrow><annotation encoding="application/x-tex">
\mathcal{L}_p = \sum_{n=1}^{N} \lambda \left| x_{t+1,n}^{(0)} - \hat{x}_{t+1,n}^{(0)} \right| + (1-\lambda) \left| x_{t+1,n}^{(1)} - \hat{x}_{t+1,n}^{(1)} \right|</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:3.0954em;vertical-align:-1.2671em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8283em;"><span style="top:-1.8829em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">N</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2671em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">λ</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.15em;"><span style="top:-3.15em;"><span class="pstrut" style="height:3.8em;"></span><span style="width:0.333em;height:1.800em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.333em' height='1.800em' viewBox='0 0 333 1800'><path d='M145 15 v585 v600 v585 c2.667,10,9.667,15,21,15
c10,0,16.667,-5,20,-15 v-585 v-600 v-585 c-2.667,-10,-9.667,-15,-21,-15
c-10,0,-16.667,5,-20,15z M188 15 H145 v585 v600 v585 h43z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.65em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0448em;"><span style="top:-2.4337em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">+</span><span class="mord mtight">1</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">n</span></span></span></span><span style="top:-3.2198em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mtight">0</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4024em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6944em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">x</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2222em;"><span class="mord">^</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0448em;"><span style="top:-2.4337em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">+</span><span class="mord mtight">1</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">n</span></span></span></span><span style="top:-3.2198em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mtight">0</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4024em;"><span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.15em;"><span style="top:-3.15em;"><span class="pstrut" style="height:3.8em;"></span><span style="width:0.333em;height:1.800em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.333em' height='1.800em' viewBox='0 0 333 1800'><path d='M145 15 v585 v600 v585 c2.667,10,9.667,15,21,15
c10,0,16.667,-5,20,-15 v-585 v-600 v-585 c-2.667,-10,-9.667,-15,-21,-15
c-10,0,-16.667,5,-20,15z M188 15 H145 v585 v600 v585 h43z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.65em;"><span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.8em;vertical-align:-0.65em;"></span><span class="mord mathnormal">λ</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.15em;"><span style="top:-3.15em;"><span class="pstrut" style="height:3.8em;"></span><span style="width:0.333em;height:1.800em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.333em' height='1.800em' viewBox='0 0 333 1800'><path d='M145 15 v585 v600 v585 c2.667,10,9.667,15,21,15
c10,0,16.667,-5,20,-15 v-585 v-600 v-585 c-2.667,-10,-9.667,-15,-21,-15
c-10,0,-16.667,5,-20,15z M188 15 H145 v585 v600 v585 h43z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.65em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0448em;"><span style="top:-2.4337em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">+</span><span class="mord mtight">1</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">n</span></span></span></span><span style="top:-3.2198em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mtight">1</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4024em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6944em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">x</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2222em;"><span class="mord">^</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0448em;"><span style="top:-2.4337em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">+</span><span class="mord mtight">1</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">n</span></span></span></span><span style="top:-3.2198em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mtight">1</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4024em;"><span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.15em;"><span style="top:-3.15em;"><span class="pstrut" style="height:3.8em;"></span><span style="width:0.333em;height:1.800em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.333em' height='1.800em' viewBox='0 0 333 1800'><path d='M145 15 v585 v600 v585 c2.667,10,9.667,15,21,15
c10,0,16.667,-5,20,-15 v-585 v-600 v-585 c-2.667,-10,-9.667,-15,-21,-15
c-10,0,-16.667,5,-20,15z M188 15 H145 v585 v600 v585 h43z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.65em;"><span></span></span></span></span></span></span></span></span></span></span></span></div></figure><p id="11ae1c97-a3fd-80c2-9403-c3b29861f06e" class="">其中，<style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>x</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn><mo separator="true">,</mo><mi>n</mi></mrow><mrow><mo stretchy="false">(</mo><mn>0</mn><mo stretchy="false">)</mo></mrow></msubsup></mrow><annotation encoding="application/x-tex">x_{t+1,n}^{(0)}  </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.4472em;vertical-align:-0.4024em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0448em;"><span style="top:-2.4337em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">+</span><span class="mord mtight">1</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">n</span></span></span></span><span style="top:-3.2198em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mtight">0</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4024em;"><span></span></span></span></span></span></span></span></span></span></span><span>﻿</span></span>和  <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>x</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn><mo separator="true">,</mo><mi>n</mi></mrow><mrow><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></msubsup><mtext>  </mtext></mrow><annotation encoding="application/x-tex">x_{t+1,n}^{(1)}  </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.4472em;vertical-align:-0.4024em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0448em;"><span style="top:-2.4337em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">+</span><span class="mord mtight">1</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">n</span></span></span></span><span style="top:-3.2198em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mtight">1</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4024em;"><span></span></span></span></span></span></span><span class="mord">  </span></span></span></span></span><span>﻿</span></span>分别代表区域 <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>r</mi><mi>n</mi></msub><mtext>  </mtext></mrow><annotation encoding="application/x-tex">r_n  </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">  </span></span></span></span></span><span>﻿</span></span>的流入和流出量，<style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext> </mtext><mi>λ</mi><mtext>  </mtext></mrow><annotation encoding="application/x-tex"> \lambda  </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord"> </span><span class="mord mathnormal">λ</span><span class="mord">  </span></span></span></span></span><span>﻿</span></span>是控制流入与流出平衡的权重。</p><p id="11ae1c97-a3fd-80b1-bd8a-ce337e415120" class="">
</p><h3 id="11ae1c97-a3fd-8039-915a-f573562356b8" class=""><strong>空间异质性建模任务</strong></h3><p id="11ae1c97-a3fd-80a1-bf67-c9f48ca295a1" class="">空间异质性建模任务旨在通过自监督学习建模不同区域之间的空间异质性。不同的城市区域（如住宅区、商业区、交通枢纽）具有不同的流量分布特性。为了解区域之间的这些差异，模型通过软聚(soft clustering) 对不同区域进行分类，并构建自监督任务进行学习。具体操作如下：</p><ul id="11ae1c97-a3fd-80c7-a124-d94af920a6c7" class="bulleted-list"><li style="list-style-type:disc">为每个区域生成  <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>K</mi></mrow><annotation encoding="application/x-tex">K</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">K</span></span></span></span></span><span>﻿</span></span> 个聚类嵌入 (cluster embeddings)，并通过计算每个区域嵌入 <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>h</mi><mi>n</mi></msub><mtext>  </mtext></mrow><annotation encoding="application/x-tex">h_n  </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">  </span></span></span></span></span><span>﻿</span></span>与聚类中心之间的相似度，来决定该区域所属的聚类类别。计算公式如下：</li></ul><figure id="11ae1c97-a3fd-80db-bea1-e630752be777" class="equation"><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><div class="equation-container"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>z</mi><mrow><mi>n</mi><mo separator="true">,</mo><mi>k</mi></mrow></msub><mo>=</mo><msubsup><mi>c</mi><mi>k</mi><mi mathvariant="normal">⊤</mi></msubsup><msub><mi>h</mi><mi>n</mi></msub></mrow><annotation encoding="application/x-tex">
z_{n,k} = c_k^\top h_n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7167em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.044em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.1461em;vertical-align:-0.247em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8991em;"><span style="top:-2.453em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">⊤</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span></div></figure><p id="11ae1c97-a3fd-80eb-ab9c-fa8064f22d09" class="">其中，<style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>z</mi><mrow><mi>n</mi><mo separator="true">,</mo><mi>k</mi></mrow></msub><mtext>  </mtext></mrow><annotation encoding="application/x-tex">z_{n,k}  </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7167em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.044em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mord">  </span></span></span></span></span><span>﻿</span></span>表示区域 <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>r</mi><mi>n</mi></msub><mtext>  </mtext></mrow><annotation encoding="application/x-tex">r_n  </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">  </span></span></span></span></span><span>﻿</span></span>与第 <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mtext>  </mtext></mrow><annotation encoding="application/x-tex">k  </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mord">  </span></span></span></span></span><span>﻿</span></span>个聚类的相关性得分，<style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>c</mi><mi>k</mi></msub><mtext>  </mtext></mrow><annotation encoding="application/x-tex">c_k  </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">  </span></span></span></span></span><span>﻿</span></span>为第 <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mtext>  </mtext></mrow><annotation encoding="application/x-tex">k  </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mord">  </span></span></span></span></span><span>﻿</span></span>个聚类的嵌入。</p><ul id="11ae1c97-a3fd-80db-8630-f66ec40937fc" class="bulleted-list"><li style="list-style-type:disc">通过预测原始图数据中区域嵌入 <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>h</mi><mi>n</mi></msub><mtext>  </mtext></mrow><annotation encoding="application/x-tex">h_n  </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">  </span></span></span></span></span><span>﻿</span></span>的聚类分配，并对增强后的数据进行软聚类，优化以下损失函数来实现自监督学习：</li></ul><figure id="11ae1c97-a3fd-80bc-bc75-fb538593af59" class="equation"><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><div class="equation-container"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi mathvariant="script">L</mi><mi>s</mi></msub><mo>=</mo><munderover><mo>∑</mo><mrow><mi>n</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></munderover><munderover><mo>∑</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>K</mi></munderover><msub><mi>z</mi><mrow><mi>n</mi><mo separator="true">,</mo><mi>k</mi></mrow></msub><mi>log</mi><mo>⁡</mo><mrow><mo fence="true">(</mo><mfrac><mrow><mi>exp</mi><mo>⁡</mo><mo stretchy="false">(</mo><msub><mi>z</mi><mrow><mi>n</mi><mo separator="true">,</mo><mi>k</mi></mrow></msub><mi mathvariant="normal">/</mi><mi>γ</mi><mo stretchy="false">)</mo></mrow><mrow><munderover><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>K</mi></munderover><mi>exp</mi><mo>⁡</mo><mo stretchy="false">(</mo><msub><mi>z</mi><mrow><mi>n</mi><mo separator="true">,</mo><mi>j</mi></mrow></msub><mi mathvariant="normal">/</mi><mi>γ</mi><mo stretchy="false">)</mo></mrow></mfrac><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">
\mathcal{L}_s = \sum_{n=1}^{N} \sum_{k=1}^{K} z_{n,k} \log \left( \frac{\exp(z_{n,k}/\gamma)}{\sum_{j=1}^{K} \exp(z_{n,j}/\gamma)} \right)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:3.1354em;vertical-align:-1.307em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8283em;"><span style="top:-1.8829em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">N</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2671em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8283em;"><span style="top:-1.8479em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.07153em;">K</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.3021em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.044em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size4">(</span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.427em;"><span style="top:-2.1288em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9812em;"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.07153em;">K</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4358em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop">exp</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.044em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mord">/</span><span class="mord mathnormal" style="margin-right:0.05556em;">γ</span><span class="mclose">)</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mop">exp</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.044em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mord">/</span><span class="mord mathnormal" style="margin-right:0.05556em;">γ</span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.307em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size4">)</span></span></span></span></span></span></span></div></figure><p id="11ae1c97-a3fd-8065-8098-d1dbcfad803f" class="">
</p><h3 id="11ae1c97-a3fd-8022-91da-d4816a72644c" class=""><strong>时间异质性建模任务</strong></h3><p id="11ae1c97-a3fd-80d8-ba2d-d485b2f6c2eb" class="">时间异质性建模任务的目标是通过自监督学习来建模不同时间步之间的时间异质性。交通流量在一天的不同时间段（如早高峰、晚高峰、夜间）具有不同的变化模式，因此模型需要捕捉这些时间模式的差异。具体过程如下:</p><ul id="11ae1c97-a3fd-805f-9cee-edcbb0a2d2b0" class="bulleted-list"><li style="list-style-type:disc"><strong>嵌入融合：</strong>首先，将原始交通流图数据和增强数据的区域嵌入进行融合，生成新的时间感知嵌入 <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>v</mi><mrow><mi>t</mi><mo separator="true">,</mo><mi>n</mi></mrow></msub><mtext> </mtext></mrow><annotation encoding="application/x-tex">v_{t,n} </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7167em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mord"> </span></span></span></span></span><span>﻿</span></span>，公式如下：</li></ul><figure id="11ae1c97-a3fd-8000-a96c-e94601d59f47" class="equation"><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><div class="equation-container"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>v</mi><mrow><mi>t</mi><mo separator="true">,</mo><mi>n</mi></mrow></msub><mo>=</mo><msub><mi>w</mi><mn>1</mn></msub><mo>⊙</mo><msub><mi>h</mi><mrow><mi>t</mi><mo separator="true">,</mo><mi>n</mi></mrow></msub><mo>+</mo><msub><mi>w</mi><mn>2</mn></msub><mo>⊙</mo><msub><mover accent="true"><mi>h</mi><mo>~</mo></mover><mrow><mi>t</mi><mo separator="true">,</mo><mi>n</mi></mrow></msub></mrow><annotation encoding="application/x-tex">
v_{t,n} = w_1 \odot h_{t,n} + w_2 \odot \tilde{h}_{t,n}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7167em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⊙</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.9805em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⊙</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.2174em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9313em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">h</span></span><span style="top:-3.6134em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.25em;"><span class="mord">~</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span></span></div></figure><p id="11ae1c97-a3fd-801d-94fd-e6bbd4e1eab4" class="">其中，<style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext> </mtext><msub><mi>w</mi><mn>1</mn></msub><mtext>  </mtext></mrow><annotation encoding="application/x-tex"> w_1  </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"> </span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">  </span></span></span></span></span><span>﻿</span></span>和 <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>w</mi><mn>2</mn></msub><mtext>  </mtext></mrow><annotation encoding="application/x-tex">w_2  </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">  </span></span></span></span></span><span>﻿</span></span>是可学习的参数，<style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>⊙</mo><mtext>  </mtext></mrow><annotation encoding="application/x-tex">\odot  </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord">⊙</span><span class="mord">  </span></span></span></span></span><span>﻿</span></span>表示逐元素点乘，<style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext> </mtext><msub><mi>h</mi><mrow><mi>t</mi><mo separator="true">,</mo><mi>n</mi></mrow></msub><mtext> </mtext></mrow><annotation encoding="application/x-tex"> h_{t,n} </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9805em;vertical-align:-0.2861em;"></span><span class="mord"> </span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mord"> </span></span></span></span></span><span>﻿</span></span>表示区域  <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>r</mi><mi>n</mi></msub><mtext>  </mtext></mrow><annotation encoding="application/x-tex">r_n  </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">  </span></span></span></span></span><span>﻿</span></span>在该时间点的时空特征，该嵌入是通过时空编码器生成的，<style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover accent="true"><mi>h</mi><mo>~</mo></mover><mrow><mi>t</mi><mo separator="true">,</mo><mi>n</mi></mrow></msub><mtext> </mtext></mrow><annotation encoding="application/x-tex">	 \tilde{h}_{t,n} </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.2174em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9313em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">h</span></span><span style="top:-3.6134em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.25em;"><span class="mord">~</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mord"> </span></span></span></span></span><span>﻿</span></span>增强后的交通流数据通过编码器后生成的嵌入，表示的是经过自适应数据增强处理后的区域 <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>r</mi><mi>n</mi></msub><mtext>  </mtext></mrow><annotation encoding="application/x-tex">r_n  </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">  </span></span></span></span></span><span>﻿</span></span>在时间步 <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext> </mtext><mi>t</mi><mtext>  </mtext></mrow><annotation encoding="application/x-tex"> t  </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6151em;"></span><span class="mord"> </span><span class="mord mathnormal">t</span><span class="mord">  </span></span></span></span></span><span>﻿</span></span>的嵌入。</p><ul id="11ae1c97-a3fd-8059-8ca8-fb25d4e61d68" class="bulleted-list"><li style="list-style-type:disc"><strong>城市级别表示：</strong>在每个时间步  <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi></mrow><annotation encoding="application/x-tex">t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6151em;"></span><span class="mord mathnormal">t</span></span></span></span></span><span>﻿</span></span>，通过将所有区域的嵌入 <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>v</mi><mrow><mi>t</mi><mo separator="true">,</mo><mi>n</mi></mrow></msub><mtext>  </mtext></mrow><annotation encoding="application/x-tex">v_{t,n}  </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7167em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mord">  </span></span></span></span></span><span>﻿</span></span>聚合，生成城市级别的时间感知表示 <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>s</mi><mi>t</mi></msub><mtext> </mtext></mrow><annotation encoding="application/x-tex">s_t </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"> </span></span></span></span></span><span>﻿</span></span>：</li></ul><figure id="11ae1c97-a3fd-806e-b7b0-c86178e0c04c" class="equation"><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><div class="equation-container"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>s</mi><mi>t</mi></msub><mo>=</mo><mi>σ</mi><mrow><mo fence="true">(</mo><mfrac><mn>1</mn><mi>N</mi></mfrac><munderover><mo>∑</mo><mrow><mi>n</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></munderover><msub><mi>v</mi><mrow><mi>t</mi><mo separator="true">,</mo><mi>n</mi></mrow></msub><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">
s_t = \sigma \left( \frac{1}{N} \sum_{n=1}^{N} v_{t,n} \right)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:3.0954em;vertical-align:-1.2671em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size4">(</span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">N</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8283em;"><span style="top:-1.8829em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">N</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2671em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size4">)</span></span></span></span></span></span></span></div></figure><ul id="11ae1c97-a3fd-80ad-9edc-e0ca9179f03f" class="bulleted-list"><li style="list-style-type:disc"><strong>对比学习：</strong>该任务通过对比学习的方式建模时间异质性，正对相同时间步的区域嵌入和城市级别嵌入作为正样本对，不同时间步的数据作为负样本对。优化以下损失函数：</li></ul><figure id="11ae1c97-a3fd-80ec-859e-d8dcd5089dc1" class="equation"><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><div class="equation-container"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi mathvariant="script">L</mi><mi>t</mi></msub><mo>=</mo><mo>−</mo><mrow><mo fence="true">(</mo><munderover><mo>∑</mo><mrow><mi>n</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></munderover><mi>log</mi><mo>⁡</mo><mi>g</mi><mo stretchy="false">(</mo><msub><mi>v</mi><mrow><mi>t</mi><mo separator="true">,</mo><mi>n</mi></mrow></msub><mo separator="true">,</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy="false">)</mo><mo>+</mo><munderover><mo>∑</mo><mrow><mi>n</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></munderover><mi>log</mi><mo>⁡</mo><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mi>g</mi><mo stretchy="false">(</mo><msub><mi>v</mi><mrow><mi>t</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo><mo separator="true">,</mo><mi>n</mi></mrow></msub><mo separator="true">,</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">
\mathcal{L}_t = -\left( \sum_{n=1}^{N} \log g(v_{t,n}, s_t) + \sum_{n=1}^{N} \log (1 - g(v_{t{\prime},n}, s_t)) \right)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:3.0954em;vertical-align:-1.2671em;"></span><span class="mord">−</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size4">(</span></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8283em;"><span style="top:-1.8829em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">N</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2671em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8283em;"><span style="top:-1.8829em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">N</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2671em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mord mtight"><span class="mord mtight">′</span></span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">))</span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size4">)</span></span></span></span></span></span></span></div></figure><p id="11ae1c97-a3fd-8095-92d1-d9bd66b45c43" class="">其中，<style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>g</mi><mo stretchy="false">(</mo><msub><mi>v</mi><mrow><mi>t</mi><mo separator="true">,</mo><mi>n</mi></mrow></msub><mo separator="true">,</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy="false">)</mo><mo>=</mo><mi>σ</mi><mo stretchy="false">(</mo><msubsup><mi>v</mi><mrow><mi>t</mi><mo separator="true">,</mo><mi>n</mi></mrow><mi mathvariant="normal">⊤</mi></msubsup><msub><mi>W</mi><mn>3</mn></msub><msub><mi>s</mi><mi>t</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">g(v_{t,n}, s_t) = \sigma(v_{t,n}^\top W_3 s_t)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0361em;vertical-align:-0.2861em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.2322em;vertical-align:-0.3831em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8491em;"><span style="top:-2.453em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">n</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">⊤</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3831em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span><span>﻿</span></span> ，<style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>W</mi><mn>3</mn></msub><mtext>  </mtext></mrow><annotation encoding="application/x-tex">W_3  </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">  </span></span></span></span></span><span>﻿</span></span>是可学习的变换矩阵 <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi><mo separator="true">,</mo><mtext> </mtext><mi>t</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></mrow><annotation encoding="application/x-tex">t,\ t{\prime}  </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8095em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">t</span><span class="mpunct">,</span><span class="mspace"> </span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">t</span><span class="mord"><span class="mord">′</span></span></span></span></span></span><span>﻿</span></span> 表示不同的时间步。</p><p id="11ae1c97-a3fd-80ed-9a62-ed2999b8fd01" class="">通过这个任务，模型能够更好地捕捉不同时间段的交通模式变化，提升对不同时间段的定制化建模能力。</p><p id="11ae1c97-a3fd-806e-99eb-e750e4f7ff5f" class="">
</p><h3 id="11ae1c97-a3fd-80fd-987a-c108d1b7c342" class="">优化目标</h3><p id="11ae1c97-a3fd-8087-bda7-d58c6cff754a" class="">在多任务学习阶段，模型的最终优化目标是将这三个任务的损失函数联合起来进行训练，通过<strong>联合损失</strong>来实现整个模型的优化。最终的损失函数定义为：</p><figure id="11ae1c97-a3fd-80e4-83f0-fa2be71071a7" class="equation"><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><div class="equation-container"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi mathvariant="script">L</mi><mtext>joint</mtext></msub><mo>=</mo><msub><mi mathvariant="script">L</mi><mi>p</mi></msub><mo>+</mo><msub><mi mathvariant="script">L</mi><mi>s</mi></msub><mo>+</mo><msub><mi mathvariant="script">L</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">
\mathcal{L}_{\text{joint}} = \mathcal{L}_p + \mathcal{L}_s + \mathcal{L}_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3175em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">joint</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span></div></figure><h1 id="11ae1c97-a3fd-80f3-850a-d690a1a776ad" class="">三、实验分析</h1><h2 id="11ae1c97-a3fd-8086-b16a-f269b9b5b30d" class="">3.1 实验设置</h2><h3 id="11ae1c97-a3fd-8098-bb20-c402c292c8e4" class="">数据集介绍</h3><p id="11ae1c97-a3fd-80b4-9c89-df845d58d995" class="">本文使用了四个真实的交通流量数据集，如图5所示。<strong>NYCBike1</strong> 和 <strong>NYCBike2</strong>：代表纽约市的自行车租赁记录，分别包含从2014年和2016年的交通数据。<strong>NYCTaxi</strong> 和 <strong>BJTaxi</strong>：代表纽约和北京的出租车GPS轨迹数据。对于所有数据集，本文使用前2小时交通流和前3天交通流来预测下一个时间步的交通流。数据集按照7:1:2的比例进行训练集、验证集和测试集的划分。</p><figure id="11ae1c97-a3fd-80df-89a2-cb2085acaef1" class="image"><a href="ST-SSL%20Spatio-Temporal%20Self-Supervised%20Learning%20fo%2011ae1c97a3fd80d1a1f4e119e404f80b/image%203.png"><img style="width:707.9765625px" src="ST-SSL%20Spatio-Temporal%20Self-Supervised%20Learning%20fo%2011ae1c97a3fd80d1a1f4e119e404f80b/image%203.png"/></a></figure><p id="11ae1c97-a3fd-80b2-b5e9-e6c092c32860" class="">                                                            <strong>       图5 数据集统计信息</strong></p><h3 id="11ae1c97-a3fd-8042-98ef-cf5d1aa0352c" class="">评估指标</h3><p id="11ae1c97-a3fd-8086-aa34-f17ca71836a5" class="">本文使用MAE（Mean Absolute Error, 平均绝对误差）和 MAPE（Mean Absolute Percentage Error, 平均绝对百分比误差）来衡量预测的性能。MAE用于衡量预测值与真实值之间的绝对误差。值越小，预测效果越好。MAPE 用于评估预测值与真实值的百分比误差，适合衡量预测值相对真实值的变化程度。</p><p id="11ae1c97-a3fd-8086-b80c-c80f6df9aed8" class="">
</p><h3 id="11ae1c97-a3fd-8069-8f0a-daaa39bed7b1" class="">实验评估</h3><p id="11ae1c97-a3fd-80ec-b79a-e729d70f91ef" class="">实验中使用了8个基线模型，与本文提出的ST-SSL框架进行对比如图6所示。可以看出在所有四个数据集上，ST-SSL的预测误差（MAE和MAPE）显著低于传统的时间序列模型和其他基于深度学习的时空预测模型。</p><figure id="11ae1c97-a3fd-80ff-9fd6-f1841da36447" class="image"><a href="ST-SSL%20Spatio-Temporal%20Self-Supervised%20Learning%20fo%2011ae1c97a3fd80d1a1f4e119e404f80b/image%204.png"><img style="width:2848px" src="ST-SSL%20Spatio-Temporal%20Self-Supervised%20Learning%20fo%2011ae1c97a3fd80d1a1f4e119e404f80b/image%204.png"/></a></figure><p id="11ae1c97-a3fd-80d2-9497-ca845bb12d35" class="">                                                            <strong>       图6 模型性能评估与比较</strong></p><p id="11ae1c97-a3fd-800c-8519-e94db709b9f9" class="">此外，文章还进一步对区域的预测误差进行了可视化，并对比了不同基线模型的预测误差，如图7所示。其中更亮的像素意味着更大的误差，进一步展示了ST-SSL的优越性能。</p><figure id="11ae1c97-a3fd-80e2-8a8b-dbe96d1d941f" class="image"><a href="ST-SSL%20Spatio-Temporal%20Self-Supervised%20Learning%20fo%2011ae1c97a3fd80d1a1f4e119e404f80b/image%205.png"><img style="width:707.984375px" src="ST-SSL%20Spatio-Temporal%20Self-Supervised%20Learning%20fo%2011ae1c97a3fd80d1a1f4e119e404f80b/image%205.png"/></a></figure><p id="11ae1c97-a3fd-807c-aa87-cc4ccce73802" class="">                                                            <strong>       图7 模型区域误差可视化</strong></p><h3 id="11ae1c97-a3fd-8070-bbd8-e9e34845a392" class="">消融实验</h3><p id="11ae1c97-a3fd-80e5-93aa-ea8c5b1d1ca2" class="">为了验证各个模块对模型整体性能的贡献，论文进行了消融实验，依次移除了ST-SSL的不同组件（如自适应增强、空间异质性建模、时间异质性建模）：</p><ul id="11ae1c97-a3fd-806b-9d4d-d3e54332105c" class="bulleted-list"><li style="list-style-type:disc"><strong>ST-SSL-sa</strong>：用随机去除和增加边来替换异质性引导的图拓扑结构增广。</li></ul><ul id="11ae1c97-a3fd-8020-9f28-c17a2a848679" class="bulleted-list"><li style="list-style-type:disc"><strong>ST-SSL-ta</strong>： 用随机交通量掩码替代异质性引导的交通流级增广。</li></ul><ul id="11ae1c97-a3fd-80e7-8afc-dce79acf7c27" class="bulleted-list"><li style="list-style-type:disc"><strong>ST-SSL-sh</strong>：去除空间异质性建模任务。</li></ul><ul id="11ae1c97-a3fd-805a-80f9-d84dfb0e03de" class="bulleted-list"><li style="list-style-type:disc"><strong>ST-SSL-th</strong>：去除时间异质性建模任务。</li></ul><p id="11ae1c97-a3fd-802a-872e-e9ef4b91e25a" class="">实验结果如图7所示。实验结果表明自适应数据增强（无论是交通级别还是图结构级别）对模型的提升至关重要。随机增强方式的模型性能显著下降，证明了异质性感知增强策略的有效性。<mark class="highlight-red">（感觉这里是否应该还需要考虑对比去除数据增强的效果？</mark>）去除空间或时间异质性建模的模型也会导致预测精度下降，这表明同时考虑时空异质性对提高整体性能至关重要。</p><figure id="11ae1c97-a3fd-80a3-8e18-c09c628f4b29" class="image"><a href="ST-SSL%20Spatio-Temporal%20Self-Supervised%20Learning%20fo%2011ae1c97a3fd80d1a1f4e119e404f80b/image%206.png"><img style="width:707.984375px" src="ST-SSL%20Spatio-Temporal%20Self-Supervised%20Learning%20fo%2011ae1c97a3fd80d1a1f4e119e404f80b/image%206.png"/></a></figure><p id="11ae1c97-a3fd-80cf-968c-cc286d8075df" class="">                                                            <strong>       图7 ST-SSL模型不同模块的消融实验</strong></p><p id="11ae1c97-a3fd-80df-acde-f3da8176059e" class="">
</p><h3 id="11ae1c97-a3fd-8035-a0df-d7c7a812ce91" class=""><strong>模型对异质性数据的鲁棒性</strong></h3><p id="11ae1c97-a3fd-8057-9a06-dd55a96d15d5" class="">为了进一步探究ST-SSL的鲁棒性，文章在北京出租车数据集上对具有异构数据分布的空间区域和具有不同模式的时间段进行了流量预测。通过交通流量统计数据（如均值、标准差等）对城市区域进行的聚类分析。每个区域被分配一个聚类ID，较低的聚类ID表示该区域流量相对较少（例如，郊区），而较高的聚类ID则代表流量较大的区域（例如，市中心）。如图8 (a) 所示，不同颜色和标签的区域表示其流量特征和区域功能的不同。对于时间异质性而言，文章将工作日分为四个时段，将节假日分为2个时段。如图8 (c)所示。空间异质性性能表现和时间异质性性能表现分别如图8 (b)和8 (d)所示，可以发现ST-SSL优于几个SOTA方法。</p><figure id="11ae1c97-a3fd-80de-ad79-dc1b85ccb6dd" class="image"><a href="ST-SSL%20Spatio-Temporal%20Self-Supervised%20Learning%20fo%2011ae1c97a3fd80d1a1f4e119e404f80b/image%207.png"><img style="width:707.984375px" src="ST-SSL%20Spatio-Temporal%20Self-Supervised%20Learning%20fo%2011ae1c97a3fd80d1a1f4e119e404f80b/image%207.png"/></a></figure><p id="11ae1c97-a3fd-802e-bfe6-d5f66455b9c3" class="">                                                            <strong>       图8 时空异质性区域性能表现</strong></p><p id="11ae1c97-a3fd-80fb-9545-d7e0c6831c3c" class="">
</p><h3 id="11ae1c97-a3fd-8030-a590-d2cb79bd34c4" class=""><strong>图结构级别增强分析</strong></h3><p id="11ae1c97-a3fd-8091-a65d-e37e4ec6c409" class="">通过图结构级别增强，ST-SSL能够自适应地调整区域间的依赖关系，如图9所示，通过颜色深度展示了模型在图结构级别增强过程中自适应调整的连接情况，突出表现了哪些区域在流量模式上高度相关、哪些区域则不太相关。因此通过图结构级别数据增强，ST-SSL不仅能够有效移除那些交通模式关联性较低的区域连接，还能捕捉到在全球城市背景下长期存在的区域间依赖关系。</p><figure id="11ae1c97-a3fd-80df-92ca-dadadcaca36a" class="image"><a href="ST-SSL%20Spatio-Temporal%20Self-Supervised%20Learning%20fo%2011ae1c97a3fd80d1a1f4e119e404f80b/image%208.png"><img style="width:707.984375px" src="ST-SSL%20Spatio-Temporal%20Self-Supervised%20Learning%20fo%2011ae1c97a3fd80d1a1f4e119e404f80b/image%208.png"/></a></figure><p id="11ae1c97-a3fd-80eb-80bf-ecc76f923321" class="">                                                            <strong>       图9 图结构级别增强分析</strong></p><p id="11ae1c97-a3fd-80ed-a7aa-ea3b3ffb7235" class="">
</p><h3 id="11ae1c97-a3fd-8096-8d29-daffcbc830bb" class="">可视化嵌入分析</h3><p id="11ae1c97-a3fd-809f-95ea-da1565a7a8fe" class="">为了进一步探讨为什么 ST-SSL 获得的嵌入可以提供比 AGCRN 更准确的流量预测，文章通过使用  t-SNE 在 BJTaxi 上将它们可视化。如图10所示，对于 ST-SSL，同一类中的样本更加紧凑，不同类中的样本明显更好地分离。这表明ST-SSL可以更好的解决空间异质性问题，从而有利于预测</p><figure id="11ae1c97-a3fd-803b-9804-d03334b057ca" class="image"><a href="ST-SSL%20Spatio-Temporal%20Self-Supervised%20Learning%20fo%2011ae1c97a3fd80d1a1f4e119e404f80b/image%209.png"><img style="width:707.9921875px" src="ST-SSL%20Spatio-Temporal%20Self-Supervised%20Learning%20fo%2011ae1c97a3fd80d1a1f4e119e404f80b/image%209.png"/></a></figure><p id="11ae1c97-a3fd-8030-a6d1-e79c4db72040" class="">                                                            <strong>       图10 ST-SSL嵌入可视化</strong></p><p id="11ae1c97-a3fd-80b1-a20c-f1350ae50128" class="">
</p><h1 id="11ae1c97-a3fd-8009-b93f-d5989abde4d1" class="">四、文章贡献与启发</h1><h3 id="11ae1c97-a3fd-80c6-a5ed-d47c23839979" class="">主要贡献：</h3><ul id="11ae1c97-a3fd-80f3-8e53-cfc6b326a1b2" class="bulleted-list"><li style="list-style-type:disc">该论文首次提出了基于自监督学习来处理交通流量预测中的时空异质性问题的框架。通过自监督学习，不依赖人工标注数据，模型能够自动学习区域和时间的特征，具有更好的泛化能力。</li></ul><ul id="11ae1c97-a3fd-800e-8353-f79d0080d1c2" class="bulleted-list"><li style="list-style-type:disc">通过自适应的交通数据增强和图结构增强，模型能够更好地去除噪声数据，并捕捉全局交通依赖。</li></ul><ul id="11ae1c97-a3fd-80d7-8f72-d92e80838834" class="bulleted-list"><li style="list-style-type:disc">通过在模型中引入两种自监督任务（空间聚类和时间对比学习），模型能够更好地识别空间和时间的模式差异，提升整体预测能力。</li></ul><h3 id="11ae1c97-a3fd-80d0-97ae-d215551292cd" class="">可改进地方探究：</h3><ul id="11ae1c97-a3fd-8002-8747-e5394c1d788f" class="bulleted-list"><li style="list-style-type:disc">交通流量受多种因素影响，如天气条件、交通事件、节假日等。该模型似乎没有充分利用外部因素的数据，只使用了节假日的信息。此外这些因素如天气条件、交通事件等同样存在异质性问题。</li></ul><ul id="11ae1c97-a3fd-806d-9e55-ea5317276911" class="bulleted-list"><li style="list-style-type:disc">模型优化问题，该模型通过优化三个联合的损失函数来进行学习，可以考虑将空间聚类和时间对比学习这两种自监督任务设计成一个任务进行优化。</li></ul><ul id="11ae1c97-a3fd-804f-a15e-c563c4c81c20" class="bulleted-list"><li style="list-style-type:disc">实时性问题，交通流量预测是否需要实时性，以便于快速做出决策，文章并未探讨模型的推理速度。</li></ul><p id="11be1c97-a3fd-80c0-8ccf-dbc2cd290adf" class="">
</p><h3 id="11be1c97-a3fd-8091-a89c-f868037b4634" class="">对交通流预测的一些初步想法</h3><p id="11be1c97-a3fd-8031-b793-daa24563e40d" class="">是否可以引入双曲理论，或者双曲空间来对城市交通网络图进行建模，目前找不到相关在深度学习交通流预测中应用双曲理论的论文。</p><p id="11be1c97-a3fd-8068-ace2-c1e129d68f7c" class="">双曲空间（Hyperbolic Space）是一种具有负曲率的几何空间，适合表示具有<strong>层次结构</strong>的复杂数据。在双曲空间中，距离的增长速度远远快于欧氏空间，这意味着它能够更紧凑地表示高维、层次化或稀疏的数据结构。这种特性对于交通流预测中的复杂网络、时空依赖关系具有天然的优势。在我以往的研究中已经证明了双曲空间能够有效的学习到数据中的层次结构。</p><p id="11be1c97-a3fd-802a-ad26-ce8b9196e5a6" class="">交通流网络通常是一个大规模的图，节点和边的关系复杂，而双曲空间能以更低的维度有效表示这种复杂的网络结构。例如，交通网络中的道路、区域和城市的层次关系可以在双曲空间中紧凑地表示，减少计算开销的同时提高对大规模交通网络的表征能力。此外交通流预测需要同时捕捉短期和长期的时空依赖关系。双曲空间的负曲率可以在较小的距离内保留紧密关联的节点信息，同时在较远的距离上放大全局结构信息，这使得它特别适合捕捉局部和全局时空特征。并且双曲几何具有强大的嵌入能力，可以更有效地对数据进行层次化表示，这种特性有助于提升模型的泛化能力，减少过拟合现象。在交通流预测中，特别是面对稀疏或异质性数据时，双曲空间能为模型提供更好的归纳偏置，提升预测的鲁棒性。</p><h1 id="11be1c97-a3fd-801b-be63-ca4ada29b96e" class="">五、代码复现</h1><figure id="11be1c97-a3fd-80d0-9524-fa64c8720ed8"><a href="https://github.com/Echo-Ji/ST-SSL/tree/main?tab=readme-ov-file" class="bookmark source"><div class="bookmark-info"><div class="bookmark-text"><div class="bookmark-title">GitHub - Echo-Ji/ST-SSL: ST-SSL (STSSL): Spatio-Temporal Self-Supervised Learning for Traffic Flow Forecasting/Prediction</div><div class="bookmark-description">ST-SSL (STSSL): Spatio-Temporal Self-Supervised Learning for Traffic Flow Forecasting/Prediction - Echo-Ji/ST-SSL</div></div><div class="bookmark-href"><img src="https://github.com/fluidicon.png" class="icon bookmark-icon"/>https://github.com/Echo-Ji/ST-SSL/tree/main?tab=readme-ov-file</div></div><img src="https://opengraph.githubassets.com/3baf55eef8e37accf858f354ea85dfdca1eb900918ade8c23c6e4f72bbc275a2/Echo-Ji/ST-SSL" class="bookmark-image"/></a></figure><p id="11be1c97-a3fd-8059-a8c3-c2f8e54a2b66" class="">论文提供的代码非常简洁明了，但是有个小bug需要修改，张量不在同一个设备上</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="11be1c97-a3fd-8029-a085-c07b85ff7b55" class="code"><code class="language-Bash">File &quot;ST-SSL-main\model\aug.py&quot;, line 54, in aug_topology drop_prob = torch.softmax(sim_mx[edge_mask], dim=0) RuntimeError: indices should be either on cpu or on the same device as the indexed tensor (cpu)</code></pre><p id="11be1c97-a3fd-80f0-b069-f26fe9752f19" class="">将 aug.py 的第54行改为如下即可</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="11be1c97-a3fd-8041-8f2c-f5537498d6d6" class="code"><code class="language-Python">drop_prob = torch.softmax(sim_mx[edge_mask.to(&#x27;cpu&#x27;)], dim=0)</code></pre><p id="11be1c97-a3fd-80f6-9b17-e7492cfda9dd" class="">
</p><h2 id="11be1c97-a3fd-80bf-b3f5-d390935e2fdb" class="">5.1 代码详细分析</h2><h3 id="11be1c97-a3fd-80b1-9149-c21509a32372" class="">网络整体结构</h3><p id="11be1c97-a3fd-8014-b532-f2049b0a1bf3" class="">先看网络整体结构，根据论文主要分为三大任务，交通流预测，空间异质性建模任务，时间异质性建模任务。主要模块为时空编码器、时间异质性建模分支和空间异质性建模分支。</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="11be1c97-a3fd-802a-8a0d-de7e73a2e88c" class="code"><code class="language-Python">class STSSL(nn.Module):
    def __init__(self, args):
        super(STSSL, self).__init__()
        # 时空编码器（Spatial Temporal Encoder）
        # STEncoder用于提取交通流量的时空特征
        self.encoder = STEncoder(Kt=3, Ks=3, blocks=[[2, int(args.d_model//2), args.d_model], [args.d_model, int(args.d_model//2), args.d_model]], 
                        input_length=args.input_length, num_nodes=args.num_nodes, droprate=args.dropout)
        
        # 交通流量预测分支（Traffic Flow Prediction Branch）
        # MLP用于最终的交通流量预测
        self.mlp = MLP(args.d_model, args.d_output)
        
        # 时间异质性建模分支（Temporal Heterogeneity Modeling Branch）
        # TemporalHeteroModel用于捕捉不同时间步之间的异质性
        self.thm = TemporalHeteroModel(args.d_model, args.batch_size, args.num_nodes, args.device)
        
        # 空间异质性建模分支（Spatial Heterogeneity Modeling Branch）
        # SpatialHeteroModel用于捕捉不同区域之间的空间异质性
        self.shm = SpatialHeteroModel(args.d_model, args.nmb_prototype, args.batch_size, args.shm_temp)
        
        # MAE损失函数，适用于处理带有掩码的交通流量数据
        self.mae = masked_mae_loss(mask_value=5.0)
        
        self.args = args
        
    def forward(self, view1, graph):
		    # 通过空间时间编码器对输入数据view1和图结构graph进行编码
		    repr1 = self.encoder(view1, graph) # view1: n,l,v,c; graph: v,v 
		
		    # 生成空间相似性矩阵，并基于此矩阵增强图结构
		    s_sim_mx = self.fetch_spatial_sim()
		    graph2 = aug_topology(s_sim_mx, graph, percent=self.args.percent*2) # 基于相似性矩阵对图进行增强
		
		    # 生成时间相似性矩阵，并基于此矩阵增强流量数据
		    t_sim_mx = self.fetch_temporal_sim()
		    view2 = aug_traffic(t_sim_mx, view1, percent=self.args.percent) # 基于时间相似性对数据进行增强
		
		    # 通过增强后的数据再次编码
		    repr2 = self.encoder(view2, graph2)
		    return repr1, repr2  # 返回两个表示（原始表示和增强表示）
		    
    def fetch_spatial_sim(self):
        &quot;&quot;&quot;
        获取由区域嵌入生成的区域相似性矩阵。
        该函数在 spatial_sim=True 时调用，用于提取空间关系的相似性矩阵。
        :return sim_mx: tensor, 区域相似性矩阵, (v, v)
        &quot;&quot;&quot;
        return self.encoder.s_sim_mx.cpu()  # 返回编码器中计算出的空间相似性矩阵
    
    def fetch_temporal_sim(self):
        &quot;&quot;&quot;
        获取时间步嵌入生成的时间相似性矩阵。
        :return sim_mx: tensor, 时间相似性矩阵
        &quot;&quot;&quot;
        return self.encoder.t_sim_mx.cpu()  # 返回编码器中计算出的时间相似性矩阵
        
    def predict(self, z1, z2):
        &quot;&quot;&quot;
        预测未来的交通流量。
        :param z1, z2 (tensor): 输入特征张量，形状为 nvc
        :return: nlvc, l=1, c=2
        &quot;&quot;&quot;
        return self.mlp(z1)  # 使用MLP进行预测
        
    def loss(self, z1, z2, y_true, scaler, loss_weights):
        # 计算预测损失
        l1 = self.pred_loss(z1, z2, y_true, scaler)
        sep_loss = [l1.item()]
        loss = loss_weights[0] * l1  # 加权预测损失

        # 计算时间异质性损失
        l2 = self.temporal_loss(z1, z2)
        sep_loss.append(l2.item())
        loss += loss_weights[1] * l2  # 加权时间异质性损失
        
        # 计算空间异质性损失
        l3 = self.spatial_loss(z1, z2)
        sep_loss.append(l3.item())
        loss += loss_weights[2] * l3  # 加权空间异质性损失
        return loss, sep_loss  # 返回总损失和分离损失列表
        
    def loss(self, z1, z2, y_true, scaler, loss_weights):
        # 计算预测损失
        l1 = self.pred_loss(z1, z2, y_true, scaler)
        sep_loss = [l1.item()]
        loss = loss_weights[0] * l1  # 加权预测损失

        # 计算时间异质性损失
        l2 = self.temporal_loss(z1, z2)
        sep_loss.append(l2.item())
        loss += loss_weights[1] * l2  # 加权时间异质性损失
        
        # 计算空间异质性损失
        l3 = self.spatial_loss(z1, z2)
        sep_loss.append(l3.item())
        loss += loss_weights[2] * l3  # 加权空间异质性损失
        return loss, sep_loss  # 返回总损失和分离损失列表
        
    def pred_loss(self, z1, z2, y_true, scaler):
        # 通过MLP预测交通流量，并反转缩放数据
        y_pred = scaler.inverse_transform(self.predict(z1, z2))
        y_true = scaler.inverse_transform(y_true)
        
        # 计算流入和流出的加权MAE损失，yita 是控制流入与流出损失的加权系数，控制两个目标损失的权重。
        loss = self.args.yita * self.mae(y_pred[..., 0], y_true[..., 0]) + \
                (1 - self.args.yita) * self.mae(y_pred[..., 1], y_true[..., 1])
        return loss  # 返回预测损失
        
    def temporal_loss(self, z1, z2):
        # 调用时间异质性模型计算时间异质性损失
        return self.thm(z1, z2)
    
    def spatial_loss(self, z1, z2):
        # 调用空间异质性模型计算空间异质性损失
        return self.shm(z1, z2)</code></pre><p id="11be1c97-a3fd-80a1-91c0-e89c68c6859d" class="">
</p><h3 id="11be1c97-a3fd-8096-b9f0-c9f715de4958" class="">空间异质性建模</h3><p id="11be1c97-a3fd-80d0-9e68-e8286bac0f40" class="">这个模块通过软聚类和对比损失来捕捉空间异质性。通过将两个输入特征 z1 和 z2 映射到聚类空间后，计算它们之间的相似度对比损失。prototypes 定义了线性层用于生成聚类中心，sinkhorn 算法标准化了分配矩阵，使其满足行列和为1的要求。通过逐步归一化行列，该算法能够生成一个标准化的分配矩阵。</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="11be1c97-a3fd-80ca-8f76-fbe9c301f6de" class="code"><code class="language-Python">class SpatialHeteroModel(nn.Module):
    &#x27;&#x27;&#x27;
    基于软聚类范式的空间异质性建模
    &#x27;&#x27;&#x27;
    def __init__(self, c_in, nmb_prototype, batch_size, tau=0.5):
        # 初始化空间异质性建模
        # c_in: 输入特征维度
        # nmb_prototype: 聚类中心数量（原型数）
        # batch_size: 批处理大小
        # tau: 对比学习中的温度参数，控制相似度分布的平滑度
        super(SpatialHeteroModel, self).__init__()
        self.l2norm = lambda x: F.normalize(x, dim=1, p=2)  # L2归一化，用于对向量进行标准化
        self.prototypes = nn.Linear(c_in, nmb_prototype, bias=False)  # 线性层，映射到原型空间
        
        self.tau = tau  # 温度参数
        self.d_model = c_in  # 模型维度
        self.batch_size = batch_size

        for m in self.modules():
            self.weights_init(m)  # 初始化权重

    def weights_init(self, m):
        # 权重初始化，使用Xavier初始化法
        if isinstance(m, nn.Linear):
            torch.nn.init.xavier_uniform_(m.weight.data)  # Xavier初始化权重
            if m.bias is not None:
                m.bias.data.fill_(0.0)  # 如果有偏置，将其初始化为0

    def forward(self, z1, z2):
        &quot;&quot;&quot;
        计算批量数据的对比损失
        :param z1, z2: 输入特征张量，形状为 nlvc
        :return: 返回对比损失
        &quot;&quot;&quot;
        with torch.no_grad():
            w = self.prototypes.weight.data.clone()  # 克隆原型的权重
            w = self.l2norm(w)  # 对权重进行L2归一化，防止数值不稳定
            self.prototypes.weight.copy_(w)  # 归一化后的权重拷贝回去

        # z1 和 z2 经过 L2 归一化并映射到原型空间
        zc1 = self.prototypes(self.l2norm(z1.reshape(-1, self.d_model)))  # z1映射到原型空间
        zc2 = self.prototypes(self.l2norm(z2.reshape(-1, self.d_model)))  # z2映射到原型空间
        
        # 使用 Sinkhorn 算法计算软分配矩阵 q1 和 q2
        with torch.no_grad():
            q1 = sinkhorn(zc1.detach())  # zc1 分配
            q2 = sinkhorn(zc2.detach())  # zc2 分配

        # 计算对比损失
        l1 = - torch.mean(torch.sum(q1 * F.log_softmax(zc2 / self.tau, dim=1), dim=1))  # zc1 和 zc2 的对比损失
        l2 = - torch.mean(torch.sum(q2 * F.log_softmax(zc1 / self.tau, dim=1), dim=1))  # zc2 和 zc1 的对比损失
        return l1 + l2  # 返回总损失
        
@torch.no_grad()
def sinkhorn(out, epsilon=0.05, sinkhorn_iterations=3):
    # Sinkhorn 算法，标准化分配矩阵 Q
    Q = torch.exp(out / epsilon).t()  # 将分数转换为概率，形状为 KxB
    B = Q.shape[1]  # 样本数量
    K = Q.shape[0]  # 原型数量

    # 确保矩阵的和为1
    sum_Q = torch.sum(Q)
    Q /= sum_Q
    
    # 迭代标准化每行和每列
    for it in range(sinkhorn_iterations):
        Q /= torch.sum(Q, dim=1, keepdim=True)  # 每行归一化
        Q /= K
        
        Q /= torch.sum(Q, dim=0, keepdim=True)  # 每列归一化
        Q /= B

    Q *= B  # 列和恢复为1
    return Q.t()  # 返回标准化后的分配矩阵</code></pre><p id="11be1c97-a3fd-807d-baca-f5174cd6d729" class="">
</p><h3 id="11be1c97-a3fd-8012-94e2-d4353e1de91f" class="">时间异质性建模</h3><p id="11be1c97-a3fd-8060-85e4-f89a87a193a6" class="">这个模块使用对比学习来捕捉不同时间步之间的异质性。通过对比真实区域表示和打乱后区域的虚假表示，模型通过 Discriminator 学习时间步之间的特征差异。使用二分类交叉熵损失来计算真实和虚假样本的分辨损失。AvgReadout 对隐藏层的区域特征求平均，得到每个时间步的全局特征。Discriminator 模块通过双线性层计算真实和虚假样本的相似性得分，帮助模型进行对比学习，从而捕捉时间异质性。</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="11be1c97-a3fd-80e8-a4e5-ecab608badd8" class="code"><code class="language-Python">class TemporalHeteroModel(nn.Module):
    &#x27;&#x27;&#x27;通过对比学习建模时间异质性。
    &#x27;&#x27;&#x27;
    def __init__(self, c_in, batch_size, num_nodes, device):
        # 初始化时间异质性模型
        # c_in: 输入特征维度
        # batch_size: 批处理大小
        # num_nodes: 节点数量（即城市区域的数量）
        # device: 运行设备（GPU/CPU）
        super(TemporalHeteroModel, self).__init__()
        self.W1 = nn.Parameter(torch.FloatTensor(num_nodes, c_in))  # 时间步表示权重 W1
        self.W2 = nn.Parameter(torch.FloatTensor(num_nodes, c_in))  # 时间步表示权重 W2
        nn.init.kaiming_uniform_(self.W1, a=math.sqrt(5))  # 初始化 W1
        nn.init.kaiming_uniform_(self.W2, a=math.sqrt(5))  # 初始化 W2
        
        self.read = AvgReadout()  # 使用平均读取层计算时间步的平均特征
        self.disc = Discriminator(c_in)  # 判别器，用于对比学习的真假样本分辨
        self.b_xent = nn.BCEWithLogitsLoss()  # 二元交叉熵损失

        # 创建真实和虚假的标签
        lbl_rl = torch.ones(batch_size, num_nodes)  # 真实标签
        lbl_fk = torch.zeros(batch_size, num_nodes)  # 虚假标签
        lbl = torch.cat((lbl_rl, lbl_fk), dim=1)  # 合并标签
        if device == &#x27;cuda&#x27;:  # 如果使用GPU，将标签转移到GPU
            self.lbl = lbl.cuda()
        
        self.n = batch_size  # 批处理大小

    def forward(self, z1, z2):
        &#x27;&#x27;&#x27;
        :param z1, z2: 输入特征张量，形状为 nlvc
        :return loss: 返回生成分支的损失
        &#x27;&#x27;&#x27;
        # 计算加权特征 h，合并 z1 和 z2
        h = (z1 * self.W1 + z2 * self.W2).squeeze(1)  # nlvc -&gt; nvc
        s = self.read(h)  # 通过 AvgReadout 计算时间步特征的平均表示
        
        # 随机打乱区域，生成虚假表示
        idx = torch.randperm(self.n)  # 随机打乱区域索引
        shuf_h = h[idx]  # 打乱区域后的虚假表示

        logits = self.disc(s, h, shuf_h)  # 使用判别器计算真实和虚假的对比得分
        loss = self.b_xent(logits, self.lbl)  # 计算对比损失
        return loss  # 返回损失
        
class AvgReadout(nn.Module):
    &#x27;&#x27;&#x27;用于计算隐藏表示的平均值。
    &#x27;&#x27;&#x27;
    def __init__(self):
        super(AvgReadout, self).__init__()
        self.sigm = nn.Sigmoid()  # Sigmoid 激活函数

    def forward(self, h):
        &#x27;&#x27;&#x27;
        :param h: 隐藏层表示，(batch_size, num_nodes, feat_dim)
        :return s: 平均后的表示，(batch_size, feat_dim)
        &#x27;&#x27;&#x27;
        s = torch.mean(h, dim=1)  # 对区域（节点）维度求平均
        s = self.sigm(s)  
        return s  # 返回平均后的特征
        
class Discriminator(nn.Module):
    &#x27;&#x27;&#x27;用于对比学习的判别器模块。
    &#x27;&#x27;&#x27;
    def __init__(self, n_h):
        super(Discriminator, self).__init__()
        self.net = nn.Bilinear(n_h, n_h, 1)  # 使用双线性层计算特征之间的相似性

        for m in self.modules():
            self.weights_init(m)

    def weights_init(self, m):
        # 权重初始化
        if isinstance(m, nn.Bilinear):
            torch.nn.init.xavier_uniform_(m.weight.data)  # Xavier 初始化双线性层权重
            if m.bias is not None:
                m.bias.data.fill_(0.0)  # 偏置初始化为0

    def forward(self, summary, h_rl, h_fk):
        &#x27;&#x27;&#x27;
        :param summary: 全局时间步的特征表示，(batch_size, feat_dim)
        :param h_rl: 真实隐藏表示，(batch_size, num_nodes, feat_dim)
        :param h_fk: 虚假隐藏表示
        :return logits: 对比得分，(batch_size, num_nodes, 2)
        &#x27;&#x27;&#x27;
        s = torch.unsqueeze(summary, dim=1)  # 增加维度以匹配节点数量
        s = s.expand_as(h_rl).contiguous()  # 扩展 summary 维度

        # 计算真实和虚假的相似性得分
        sc_rl = torch.squeeze(self.net(h_rl, s), dim=2)  # 真实样本的得分
        sc_fk = torch.squeeze(self.net(h_fk, s), dim=2)  # 虚假样本的得分

        logits = torch.cat((sc_rl, sc_fk), dim=1)  # 将真实和虚假的得分拼接
        return logits  # 返回得分，用于对比损失计算</code></pre><p id="11be1c97-a3fd-80cd-abdf-fd0c5599dfcc" class="">
</p><h3 id="11be1c97-a3fd-80a6-8325-d73292e63061" class="">时空编码器 (ST Encoder)</h3><p id="11be1c97-a3fd-8008-ac3b-e73b40a4db07" class="">STEncoder 结合时间卷积（TemporalConvLayer）和空间卷积（SpatioConvLayer）对输入的交通流量数据进行时空特征提取。通过多层卷积块，捕捉时空依赖关系。最后通过池化层（Pooler）和归一化操作进行特征压缩和标准化。</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="11be1c97-a3fd-80e0-a64f-fbfc2220f3a9" class="code"><code class="language-Python">class STEncoder(nn.Module):
    def __init__(self, Kt, Ks, blocks, input_length, num_nodes, droprate=0.1):
        # 初始化时空编码器
        # Kt: 时间卷积核大小
        # Ks: 空间卷积的切比雪夫多项式阶数
        # blocks: 每个时空卷积块的结构配置
        # input_length: 输入的时间序列长度
        # num_nodes: 图的节点数量（区域数量）
        # droprate: dropout率
        super(STEncoder, self).__init__()
        self.Ks = Ks  # 保存空间卷积核的大小
        c = blocks[0]
        
        # 定义第一个时空卷积块的时间卷积层
        self.tconv11 = TemporalConvLayer(Kt, c[0], c[1], &quot;GLU&quot;)
        self.pooler = Pooler(input_length - (Kt - 1), c[1])  # 池化层，用于池化时间步的特征
        
        # 定义第一个时空卷积块的空间卷积层
        self.sconv12 = SpatioConvLayer(Ks, c[1], c[1])  # 空间卷积层
        self.tconv13 = TemporalConvLayer(Kt, c[1], c[2])  # 第二个时间卷积层
        self.ln1 = nn.LayerNorm([num_nodes, c[2]])  # 层归一化，防止过拟合
        self.dropout1 = nn.Dropout(droprate)  # Dropout，防止过拟合

        c = blocks[1]  # 第二个时空卷积块的配置
        self.tconv21 = TemporalConvLayer(Kt, c[0], c[1], &quot;GLU&quot;)  # 第二块的时间卷积层
        
        self.sconv22 = SpatioConvLayer(Ks, c[1], c[1])  # 第二块的空间卷积层
        self.tconv23 = TemporalConvLayer(Kt, c[1], c[2])  # 第二块的时间卷积层
        self.ln2 = nn.LayerNorm([num_nodes, c[2]])  # 层归一化
        self.dropout2 = nn.Dropout(droprate)  # Dropout

        self.s_sim_mx = None  # 存储空间相似性矩阵
        self.t_sim_mx = None  # 存储时间相似性矩阵
        
        # 计算输出的长度并定义输出卷积层
        out_len = input_length - 2 * (Kt - 1) * len(blocks)
        self.out_conv = TemporalConvLayer(out_len, c[2], c[2], &quot;GLU&quot;)  # 输出时间卷积层
        self.ln3 = nn.LayerNorm([num_nodes, c[2]])  # 输出层归一化
        self.dropout3 = nn.Dropout(droprate)  # 输出Dropout
        self.receptive_field = input_length + Kt - 1  # 计算感受野，确保输入足够长
        
    def forward(self, x0, graph):
        # 计算图的拉普拉斯矩阵，用于图卷积
        lap_mx = self._cal_laplacian(graph)
        Lk = self._cheb_polynomial(lap_mx, self.Ks)  # 计算切比雪夫多项式

        in_len = x0.size(1)  # 获取输入的时间步长度 nlvc
        if in_len &lt; self.receptive_field:
            # 如果输入长度小于感受野，进行填充
            x = F.pad(x0, (0, 0, 0, 0, self.receptive_field - in_len, 0))
        else:
            x = x0

        # 变换输入的维度顺序为 (batch_size, 特征维度, 时间长度, 节点数)
        x = x.permute(0, 3, 1, 2)  # (nclv)

        ## 第一个时空卷积块
        x = self.tconv11(x)  # 通过第一个时间卷积层
        x, x_agg, self.t_sim_mx = self.pooler(x)  # 池化时间步并生成时间相似性矩阵
        self.s_sim_mx = sim_global(x_agg, sim_type=&#x27;cos&#x27;)  # 计算空间相似性矩阵

        x = self.sconv12(x, Lk)  # 通过空间卷积层
        x = self.tconv13(x)  # 通过第二个时间卷积层
        # 通过层归一化和Dropout
        x = self.dropout1(self.ln1(x.permute(0, 2, 3, 1)).permute(0, 3, 1, 2))

        ## 第二个时空卷积块
        x = self.tconv21(x)  # 通过时间卷积层
        x = self.sconv22(x, Lk)  # 通过空间卷积层
        x = self.tconv23(x)  # 通过时间卷积层
        # 通过层归一化和Dropout
        x = self.dropout2(self.ln2(x.permute(0, 2, 3, 1)).permute(0, 3, 1, 2))

        ## 输出卷积块
        x = self.out_conv(x)  # 通过输出卷积层
        x = self.dropout3(self.ln3(x.permute(0, 2, 3, 1)))  # 最终通过层归一化和Dropout
        return x  # 输出时空特征 (nlvc)
        
    def _cheb_polynomial(self, laplacian, K):
        &quot;&quot;&quot;
        计算切比雪夫多项式，用于图卷积操作。
        :param laplacian: 图的拉普拉斯矩阵
        :param K: 多项式的阶数，多项式的阶数 K 决定了卷积的空间范围，能够捕捉更高阶的节点信息。
        :return: 切比雪夫多项式矩阵
        &quot;&quot;&quot;
        N = laplacian.size(0)  # 获取图的节点数量
        multi_order_laplacian = torch.zeros([K, N, N], device=laplacian.device, dtype=torch.float)  # 初始化
        multi_order_laplacian[0] = torch.eye(N, device=laplacian.device, dtype=torch.float)  # 0阶是单位矩阵

        if K == 1:
            return multi_order_laplacian  # 直接返回0阶多项式
        else:
            multi_order_laplacian[1] = laplacian  # 1阶是拉普拉斯矩阵
            if K == 2:
                return multi_order_laplacian  # 返回0阶和1阶
            else:
                for k in range(2, K):
                    # 递归计算高阶的切比雪夫多项式
                    multi_order_laplacian[k] = 2 * torch.mm(laplacian, multi_order_laplacian[k-1]) - \
                                               multi_order_laplacian[k-2]

        return multi_order_laplacian  # 返回所有阶数的切比雪夫多项式
        
    def _cal_laplacian(self, graph):
        &quot;&quot;&quot;
        计算图的拉普拉斯矩阵。
        :param graph: 图的邻接矩阵
        :return: 图的拉普拉斯矩阵
        &quot;&quot;&quot;
        I = torch.eye(graph.size(0), device=graph.device, dtype=graph.dtype)  # 创建单位矩阵
        graph = graph + I  # 给图添加自循环，防止度为0的节点
        D = torch.diag(torch.sum(graph, dim=-1) ** (-0.5))  # 计算度矩阵 D^-0.5
        L = I - torch.mm(torch.mm(D, graph), D)  # 计算规范化的拉普拉斯矩阵
        return L  # 返回拉普拉斯矩阵

## 这个层用于对输入和输出的通道数进行对齐操作，确保后续层输入的维度一致  
## 如果通道数不匹配，则通过1x1卷积或填充来调整     
class Align(nn.Module):
    def __init__(self, c_in, c_out):
        &#x27;&#x27;&#x27;对输入和输出进行维度对齐。&#x27;&#x27;&#x27;
        super(Align, self).__init__()
        self.c_in = c_in
        self.c_out = c_out
        if c_in &gt; c_out:
            self.conv1x1 = nn.Conv2d(c_in, c_out, 1)  # 使用1x1卷积层进行通道数对齐

    def forward(self, x):  # x: (n,c,l,v)
        if self.c_in &gt; self.c_out:
            return self.conv1x1(x)  # 如果输入通道数大于输出通道数，使用1x1卷积对齐
        if self.c_in &lt; self.c_out:
            # 如果输入通道数小于输出通道数，进行0填充
            return F.pad(x, [0, 0, 0, 0, 0, self.c_out - self.c_in, 0, 0])
        return x  # 否则直接返回原始输入

## 时间卷积层    
## 通过1D卷积处理时间维度的特征，并通过对齐层确保输入通道与输出通道的维度一致
## 支持 GLU 激活函数，它在普通卷积的基础上引入了门控机制，有助于对时间信息的处理    
class TemporalConvLayer(nn.Module):
    def __init__(self, kt, c_in, c_out, act=&quot;relu&quot;):
        # 时间卷积层的初始化
        # kt: 卷积核大小
        # c_in: 输入通道数
        # c_out: 输出通道数
        # act: 激活函数类型（GLU或ReLU）
        super(TemporalConvLayer, self).__init__()
        self.kt = kt  # 时间卷积核大小
        self.act = act  # 激活函数类型
        self.c_out = c_out  # 输出通道数
        self.align = Align(c_in, c_out)  # 对齐层，调整输入输出维度
        if self.act == &quot;GLU&quot;:
            # 如果使用GLU，卷积层输出的通道数为2倍
            self.conv = nn.Conv2d(c_in, c_out * 2, (kt, 1), 1)
        else:
            # 使用普通卷积层
            self.conv = nn.Conv2d(c_in, c_out, (kt, 1), 1)

    def forward(self, x):
        &quot;&quot;&quot;
        :param x: (n,c,l,v) -&gt; 输入的时间序列特征
        :return: (n,c,l-kt+1,v)
        &quot;&quot;&quot;
        # 调整输入的通道数，确保与卷积层的输入维度一致
        x_in = self.align(x)[:, :, self.kt - 1:, :]  
        # 根据不同激活函数计算卷积输出
        if self.act == &quot;GLU&quot;:
            x_conv = self.conv(x)
            # GLU激活函数通过门控机制调整输出
            return (x_conv[:, :self.c_out, :, :] + x_in) * torch.sigmoid(x_conv[:, self.c_out:, :, :])
        if self.act == &quot;sigmoid&quot;:
            return torch.sigmoid(self.conv(x) + x_in)  
        return torch.relu(self.conv(x) + x_in)  

## 空间卷积层
## 它使用切比雪夫多项式作为卷积核来捕捉邻居节点的空间信息        
class SpatioConvLayer(nn.Module):
    def __init__(self, ks, c_in, c_out):
        # 空间卷积层的初始化
        super(SpatioConvLayer, self).__init__()
        self.theta = nn.Parameter(torch.FloatTensor(c_in, c_out, ks))  # 卷积核参数
        self.b = nn.Parameter(torch.FloatTensor(1, c_out, 1, 1))  # 偏置参数
        self.align = Align(c_in, c_out)  # 对齐层
        self.reset_parameters()  # 初始化参数

    def reset_parameters(self):
        # 使用Kaiming初始化卷积核和偏置
        init.kaiming_uniform_(self.theta, a=math.sqrt(5))
        fan_in, _ = init._calculate_fan_in_and_fan_out(self.theta)
        bound = 1 / math.sqrt(fan_in)
        init.uniform_(self.b, -bound, bound)

    def forward(self, x, Lk):
        # 使用切比雪夫多项式的卷积操作
        x_c = torch.einsum(&quot;knm,bitm-&gt;bitkn&quot;, Lk, x)  # Lk为多阶拉普拉斯矩阵
        x_gc = torch.einsum(&quot;iok,bitkn-&gt;botn&quot;, self.theta, x_c) + self.b  # 卷积操作
        x_in = self.align(x)  # 对齐输入通道
        return torch.relu(x_gc + x_in)  
 
## 池化层，用于将区域时间序列的特征池化到区域级别
## 它使用注意力机制对时间步进行加权求和，并通过平均池化或最大池化得到区域特征。       
class Pooler(nn.Module):
    def __init__(self, n_query, d_model, agg=&#x27;avg&#x27;):
        # 初始化池化层
        # n_query: 查询数量
        # d_model: 模型的特征维度
        super(Pooler, self).__init__()

        # 注意力矩阵的全连接层
        self.att = FCLayer(d_model, n_query)
        self.align = Align(d_model, d_model)  # 对齐层
        self.softmax = nn.Softmax(dim=2)  # 对时间维度进行softmax

        self.d_model = d_model  # 模型维度
        self.n_query = n_query  # 查询数目
        # 使用平均池化或最大池化
        if agg == &#x27;avg&#x27;:
            self.agg = nn.AvgPool2d(kernel_size=(n_query, 1), stride=1)
        elif agg == &#x27;max&#x27;:
            self.agg = nn.MaxPool2d(kernel_size=(n_query, 1), stride=1)
        else:
            raise ValueError(&#x27;Pooler supports [avg, max]&#x27;)

    def forward(self, x):
        &quot;&quot;&quot;
        :param x: 区域嵌入的时间序列，形状为 nclv
        :return x: 用于卷积的隐藏层嵌入，形状为 ncqv
        :return x_agg: 区域嵌入，用于空间相似性计算，形状为 nvc
        :return A: 时间注意力矩阵，形状为 lnv
        &quot;&quot;&quot;
        x_in = self.align(x)[:, :, -self.n_query:, :]  # 对齐并截取最后n_query个时间步
        A = self.att(x)  # 计算注意力矩阵
        A = F.softmax(A, dim=2)  # 对注意力矩阵进行softmax归一化

        # 通过注意力矩阵A计算区域嵌入
        x = torch.einsum(&#x27;nclv,nqlv-&gt;ncqv&#x27;, x, A)
        x_agg = self.agg(x).squeeze(2)  # 池化后的区域嵌入
        x_agg = torch.einsum(&#x27;ncv-&gt;nvc&#x27;, x_agg)  # 调整维度

        # 计算时间相似性矩阵
        A = torch.einsum(&#x27;nqlv-&gt;lnqv&#x27;, A)
        A = self.softmax(self.agg(A).squeeze(2))  # A: lnqv -&gt; lnv
        return torch.relu(x + x_in), x_agg.detach(), A.detach()  # 返回池化后的特征、区域嵌入和时间注意力矩阵

## 简单的多层感知机，用于将时空特征转换为交通流量的预测。      
class MLP(nn.Module):
    def __init__(self, c_in, c_out): 
        # MLP 的初始化
        super(MLP, self).__init__()
        self.fc1 = FCLayer(c_in, int(c_in // 2))  # 第一层全连接层
        self.fc2 = FCLayer(int(c_in // 2), c_out)  # 第二层全连接层

    def forward(self, x):
        # 通过MLP预测未来交通流量
        x = torch.tanh(self.fc1(x.permute(0, 3, 1, 2)))  # nlvc -&gt; nclv，通过tanh激活
        x = self.fc2(x).permute(0, 2, 3, 1)  # 通过第二层全连接层输出，调整维度回到 nlvc
        return x  # 返回预测结果

## 简化的全连接层，使用1x1卷积来模拟全连接操作，方便处理输入的多维张量。        
class FCLayer(nn.Module):
    def __init__(self, c_in, c_out):
        # 初始化全连接层
        super(FCLayer, self).__init__()
        self.linear = nn.Conv2d(c_in, c_out, 1)  # 使用1x1卷积模拟全连接层

    def forward(self, x):
        return self.linear(x)  # 执行卷积操作</code></pre><p id="11be1c97-a3fd-809a-8ed4-f17d2808003c" class="">
</p><h3 id="11be1c97-a3fd-8074-8698-f36fe63d5028" class="">自适应数据增强</h3><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="11be1c97-a3fd-8027-b0aa-d6cef2e4fd4c" class="code"><code class="language-Python">## 有两种方式（余弦相似性和缩放点积相似性）计算节点的全局相似性矩阵
## 余弦相似性基于节点的 L2 范数，缩放点积相似性通过 softmax 归一化计算
def sim_global(flow_data, sim_type=&#x27;cos&#x27;):
    &quot;&quot;&quot;
    计算交通流数据的全局相似性矩阵。
    :param flow_data: 张量，输入的交通流量数据，形状为 [n,l,v,c] 或 [n,v,c]
    :param sim_type: str，相似性计算方式，&#x27;cos&#x27; 表示余弦相似性，&#x27;att&#x27; 表示缩放点积相似性。
    :return sim: 张量，对称的相似性矩阵，形状为 [v,v]。
    &quot;&quot;&quot;
    
    # 判断输入数据的维度，如果是 4 维，则是原始交通流量数据
    if len(flow_data.shape) == 4:
        n, l, v, c = flow_data.shape  # 分别是 batch 大小，时间步，节点数，特征维度
        att_scaling = n * l * c  # attention 缩放因子，用于缩放点积相似度
        # 计算每个节点的 L2 范数，用于余弦相似度计算
        cos_scaling = torch.norm(flow_data, p=2, dim=(0, 1, 3)) ** -1  
        # 计算两个节点的相似度，使用爱因斯坦求和约定进行张量乘法
        sim = torch.einsum(&#x27;btnc, btmc-&gt;nm&#x27;, flow_data, flow_data)
    
    # 如果输入数据是 3 维，则是位置嵌入数据
    elif len(flow_data.shape) == 3:
        n, v, c = flow_data.shape  # batch 大小，节点数，特征维度
        att_scaling = n * c  # attention 缩放因子
        # 计算节点的 L2 范数
        cos_scaling = torch.norm(flow_data, p=2, dim=(0, 2)) ** -1
        # 计算节点之间的相似度
        sim = torch.einsum(&#x27;bnc, bmc-&gt;nm&#x27;, flow_data, flow_data)
    
    # 如果输入数据的维度既不是 3 也不是 4，则报错
    else:
        raise ValueError(&#x27;sim_global only support shape length in [3, 4] but got {}.&#x27;.format(len(flow_data.shape)))

    # 如果使用余弦相似性
    if sim_type == &#x27;cos&#x27;:
        # 计算缩放因子，用于归一化余弦相似性
        scaling = torch.einsum(&#x27;i, j-&gt;ij&#x27;, cos_scaling, cos_scaling)
        sim = sim * scaling  # 计算余弦相似性
    
    # 如果使用缩放点积相似性
    elif sim_type == &#x27;att&#x27;:
        # 计算缩放因子，并通过 softmax 进行归一化
        scaling = float(att_scaling) ** -0.5
        sim = torch.softmax(sim * scaling, dim=-1)
    
    # 如果相似性类型既不是 &#x27;cos&#x27; 也不是 &#x27;att&#x27;，则报错
    else:
        raise ValueError(&#x27;sim_global only support sim_type in [att, cos].&#x27;)
    
    return sim  # 返回计算出的相似性矩阵

## 从拓扑结构的角度对图的邻接矩阵进行数据增强（即进行边的增加或删除）    
def aug_topology(sim_mx, input_graph, percent=0.2):
    &quot;&quot;&quot;
    从拓扑结构（图结构）角度生成数据增强（无自循环的无向图）。
    :param sim_mx: 张量，对称的相似性矩阵，形状为 [v,v]
    :param input_graph: 张量，输入的邻接矩阵（无自循环），形状为 [v,v]
    :param percent: float，增强的百分比，默认 0.2。
    :return aug_graph: 张量，增强后的邻接矩阵，形状为 [v,v]
    &quot;&quot;&quot;

    ## 边删除操作从这里开始
    drop_percent = percent / 2  # 每次删除的边占比
    
    # 获取当前图中的边列表（非零项索引）
    index_list = input_graph.nonzero()  # list of edges [row_idx, col_idx]
    
    edge_num = int(index_list.shape[0] / 2)  # 无向边将一条边视作两条边
    edge_mask = (input_graph &gt; 0).tril(diagonal=-1)  # 获取下三角矩阵，排除自环
    add_drop_num = int(edge_num * drop_percent / 2)  # 要删除和添加的边数
    aug_graph = copy.deepcopy(input_graph)  # 复制输入图，生成增强后的图

    # 根据相似性矩阵，计算边删除的概率
    drop_prob = torch.softmax(sim_mx[edge_mask.to(&#x27;cpu&#x27;)], dim=0)
    drop_prob = (1. - drop_prob).numpy()  # 将相似性转换为采样概率
    drop_prob /= drop_prob.sum()  # 归一化概率
    # 按概率随机选择要删除的边
    drop_list = np.random.choice(edge_num, size=add_drop_num, p=drop_prob)
    drop_index = index_list[drop_list]
    
    zeros = torch.zeros_like(aug_graph[0, 0])  # 创建全 0 张量，表示删除边
    aug_graph[drop_index[:, 0], drop_index[:, 1]] = zeros  # 删除边
    aug_graph[drop_index[:, 1], drop_index[:, 0]] = zeros  # 删除边（无向图）

    ## 边增加操作从这里开始
    node_num = input_graph.shape[0]  # 获取节点数量
    x, y = np.meshgrid(range(node_num), range(node_num), indexing=&#x27;ij&#x27;)  # 创建网格
    mask = y &lt; x  # 仅考虑下三角部分
    x, y = x[mask], y[mask]  # 获取所有可能的边索引

    # 计算添加边的概率
    add_prob = sim_mx[torch.ones(sim_mx.size(), dtype=bool).tril(diagonal=-1)]  # 取出下三角部分
    add_prob = torch.softmax(add_prob, dim=0).numpy()  # 归一化添加概率
    # 按概率随机选择要添加的边
    add_list = np.random.choice(int((node_num * node_num - node_num) / 2), 
                                size=add_drop_num, p=add_prob)
    
    ones = torch.ones_like(aug_graph[0, 0])  # 创建全 1 张量，表示添加边
    aug_graph[x[add_list], y[add_list]] = ones  # 添加边
    aug_graph[y[add_list], x[add_list]] = ones  # 添加边（无向图）
    
    return aug_graph  # 返回增强后的图

## 从交通流量（节点属性）的角度进行数据增强    
def aug_traffic(t_sim_mx, flow_data, percent=0.2):
    &quot;&quot;&quot;
    从交通流量的角度生成数据增强（即遮蔽部分交通数据）。
    :param t_sim_mx: temporal similarity matrix after softmax, [l,n,v]
    :param flow_data: 输入的交通流量数据，形状为 [n,l,v,c]
    :param percent: float，增强的百分比，默认 0.2。
    :return aug_flow: 增强后的交通流量数据
    &quot;&quot;&quot;
    
    l, n, v = t_sim_mx.shape  # 时间步数，批量大小，节点数
    mask_num = int(n * l * v * percent)  # 要遮蔽的总数
    aug_flow = copy.deepcopy(flow_data)  # 复制原始流量数据

    # 计算遮蔽的概率，基于相似性矩阵
    mask_prob = (1. - t_sim_mx.permute(1, 0, 2).reshape(-1)).numpy()
    mask_prob /= mask_prob.sum()  # 归一化概率

    # 创建所有可能的索引组合
    x, y, z = np.meshgrid(range(n), range(l), range(v), indexing=&#x27;ij&#x27;)
    # 按概率随机选择要遮蔽的索引
    mask_list = np.random.choice(n * l * v, size=mask_num, p=mask_prob)

    # 遮蔽部分数据（即将其设置为全 0）
    zeros = torch.zeros_like(aug_flow[0, 0, 0])
    aug_flow[
        x.reshape(-1)[mask_list], 
        y.reshape(-1)[mask_list], 
        z.reshape(-1)[mask_list]] = zeros  # 将选中的流量数据置为 0

    return aug_flow  # 返回增强后的交通流量数据</code></pre><p id="11be1c97-a3fd-80b6-a44e-e30d560d887a" class="">
</p><h2 id="11be1c97-a3fd-8062-a553-d7f09fc9af71" class="">5.2 实验结果复现分析</h2><p id="11be1c97-a3fd-804d-a3e4-e0ce63681c7d" class="">根据提供的配置文件对每个数据集使用随机生成的种子进行了五次实验，实验结果如下图所示。</p><p id="11be1c97-a3fd-80c3-89e7-d616d15e2e70" class=""><strong>MAE (In/Out)</strong>: 复现的 MAE 值与论文中给出的值几乎一致，只有微小的差异，这说明复现的模型在误差范围内保持了与论文一致的表现，训练效果非常接近。</p><p id="11be1c97-a3fd-8055-998a-e817df50658d" class=""><strong>MAPE (In/Out)</strong>: MAPE 复现的值与论文值也非常接近，但复现的 In 数据的 MAPE 波动较大。虽然误差不大，但表明复现的结果在该数据集上有轻微的波动，可能是由于随机种子等因素影响了模型的稳定性。</p><p id="11be1c97-a3fd-8010-8258-e8a13961d617" class="">NYCTaxi 数据集的复现结果，尤其是在 MAPE out上波动较大，表明在复现过程中存在一些不稳定的因素，可能是随机种子造成的，此外还存在了较为严重的过拟合现象。</p><figure id="11be1c97-a3fd-8080-836a-f0fcf4c68732" class="image"><a href="ST-SSL%20Spatio-Temporal%20Self-Supervised%20Learning%20fo%2011ae1c97a3fd80d1a1f4e119e404f80b/image%2010.png"><img style="width:707.9921875px" src="ST-SSL%20Spatio-Temporal%20Self-Supervised%20Learning%20fo%2011ae1c97a3fd80d1a1f4e119e404f80b/image%2010.png"/></a></figure><figure id="11be1c97-a3fd-8033-8880-f929f52f6095" class="image"><a href="ST-SSL%20Spatio-Temporal%20Self-Supervised%20Learning%20fo%2011ae1c97a3fd80d1a1f4e119e404f80b/image%2011.png"><img style="width:707.9921875px" src="ST-SSL%20Spatio-Temporal%20Self-Supervised%20Learning%20fo%2011ae1c97a3fd80d1a1f4e119e404f80b/image%2011.png"/></a></figure><figure id="11be1c97-a3fd-8035-a9db-e88167def08e" class="image"><a href="ST-SSL%20Spatio-Temporal%20Self-Supervised%20Learning%20fo%2011ae1c97a3fd80d1a1f4e119e404f80b/image%2012.png"><img style="width:707.9921875px" src="ST-SSL%20Spatio-Temporal%20Self-Supervised%20Learning%20fo%2011ae1c97a3fd80d1a1f4e119e404f80b/image%2012.png"/></a></figure><figure id="11be1c97-a3fd-804f-be42-eeea3bf24edf" class="image"><a href="ST-SSL%20Spatio-Temporal%20Self-Supervised%20Learning%20fo%2011ae1c97a3fd80d1a1f4e119e404f80b/image%2013.png"><img style="width:707.9921875px" src="ST-SSL%20Spatio-Temporal%20Self-Supervised%20Learning%20fo%2011ae1c97a3fd80d1a1f4e119e404f80b/image%2013.png"/></a></figure><p id="11be1c97-a3fd-80a8-9da7-d1ec45446114" class="">
</p><table id="11be1c97-a3fd-8012-8dfd-d2bf006f09c5" class="simple-table"><tbody><tr id="11be1c97-a3fd-8041-a53e-fe610dcb8a56"><td id="ioS&lt;" class="">Dataset</td><td id="AGL^" class="">Metric</td><td id="og&lt;L" class="">Type</td><td id="NmrU" class="">ST-SSL（论文）</td><td id="mp=C" class="">ST-SSL（复现）</td></tr><tr id="11be1c97-a3fd-8089-9aef-d18e1f9710c0"><td id="ioS&lt;" class="">NYCbike1</td><td id="AGL^" class="">MAE</td><td id="og&lt;L" class="">In</td><td id="NmrU" class="">4.94±0.02</td><td id="mp=C" class="">4.93±0.03</td></tr><tr id="11be1c97-a3fd-8021-838a-e886458e199d"><td id="ioS&lt;" class=""></td><td id="AGL^" class=""></td><td id="og&lt;L" class="">Out</td><td id="NmrU" class="">5.26±0.02</td><td id="mp=C" class="">5.24±0.02</td></tr><tr id="11be1c97-a3fd-801e-8ed9-fd56615b05ad"><td id="ioS&lt;" class=""></td><td id="AGL^" class="">MAPE</td><td id="og&lt;L" class="">In</td><td id="NmrU" class="">23.69±0.11</td><td id="mp=C" class="">23.43±0.36</td></tr><tr id="11be1c97-a3fd-808e-918b-e7f7adb07be6"><td id="ioS&lt;" class=""></td><td id="AGL^" class=""></td><td id="og&lt;L" class="">Out</td><td id="NmrU" class="">24.60±0.27</td><td id="mp=C" class="">24.49±0.42</td></tr><tr id="11be1c97-a3fd-80a4-966d-fe00df7461e1"><td id="ioS&lt;" class="">NYCbike2</td><td id="AGL^" class="">MAE</td><td id="og&lt;L" class="">In</td><td id="NmrU" class="">5.04±0.03</td><td id="mp=C" class="">5.05±0.03</td></tr><tr id="11be1c97-a3fd-8037-99db-f9fc7de6b6e9"><td id="ioS&lt;" class=""></td><td id="AGL^" class=""></td><td id="og&lt;L" class="">Out</td><td id="NmrU" class="">4.71±0.02</td><td id="mp=C" class="">4.72±0.05</td></tr><tr id="11be1c97-a3fd-8010-bcb8-e5964d857492"><td id="ioS&lt;" class=""></td><td id="AGL^" class="">MAPE</td><td id="og&lt;L" class="">In</td><td id="NmrU" class="">22.54±0.10</td><td id="mp=C" class="">22.78±0.31</td></tr><tr id="11be1c97-a3fd-8074-a9c9-e371327924a9"><td id="ioS&lt;" class=""></td><td id="AGL^" class=""></td><td id="og&lt;L" class="">Out</td><td id="NmrU" class="">21.17±0.13</td><td id="mp=C" class="">21.47±0.39</td></tr><tr id="11be1c97-a3fd-8075-af02-f111193a9419"><td id="ioS&lt;" class="">NYCTaxi</td><td id="AGL^" class="">MAE</td><td id="og&lt;L" class="">In</td><td id="NmrU" class="">11.99±0.12</td><td id="mp=C" class="">12.09±0.12</td></tr><tr id="11be1c97-a3fd-8039-95a6-ffb431513616"><td id="ioS&lt;" class=""></td><td id="AGL^" class=""></td><td id="og&lt;L" class="">Out</td><td id="NmrU" class="">9.78±0.09</td><td id="mp=C" class="">9.82±0.06</td></tr><tr id="11be1c97-a3fd-8009-baf4-e5da851185b0"><td id="ioS&lt;" class=""></td><td id="AGL^" class="">MAPE</td><td id="og&lt;L" class="">In</td><td id="NmrU" class="">16.38±0.10</td><td id="mp=C" class="">16.82±0.74</td></tr><tr id="11be1c97-a3fd-804a-9a87-fe87197ee168"><td id="ioS&lt;" class=""></td><td id="AGL^" class=""></td><td id="og&lt;L" class="">Out</td><td id="NmrU" class="">16.86±0.23</td><td id="mp=C" class=""><strong>18.24±1.21</strong></td></tr><tr id="11be1c97-a3fd-800a-900e-eb69966ec93b"><td id="ioS&lt;" class="">BJTaxi</td><td id="AGL^" class="">MAE</td><td id="og&lt;L" class="">In</td><td id="NmrU" class="">11.31±0.03</td><td id="mp=C" class="">11.33±0.04</td></tr><tr id="11be1c97-a3fd-803d-bf57-c2b12fe0caed"><td id="ioS&lt;" class=""></td><td id="AGL^" class=""></td><td id="og&lt;L" class="">Out</td><td id="NmrU" class="">11.40±0.02</td><td id="mp=C" class="">11.42±0.04</td></tr><tr id="11be1c97-a3fd-809d-b683-f43d4d8513b4"><td id="ioS&lt;" class=""></td><td id="AGL^" class="">MAPE</td><td id="og&lt;L" class="">In</td><td id="NmrU" class="">15.03±0.13</td><td id="mp=C" class="">15.43±0.07</td></tr><tr id="11be1c97-a3fd-801b-b7c4-c5bf75c14afc"><td id="ioS&lt;" class=""></td><td id="AGL^" class=""></td><td id="og&lt;L" class="">Out</td><td id="NmrU" class="">15.19±0.15</td><td id="mp=C" class="">15.56±0.09</td></tr></tbody></table><p id="11be1c97-a3fd-807c-9cd0-e1d14771b160" class="">
</p></div></article><span class="sans" style="font-size:14px;padding-top:2em"></span></body></html>